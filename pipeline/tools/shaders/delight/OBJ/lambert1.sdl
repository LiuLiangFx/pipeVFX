3dl
############################################################################
# File automatically generated by the 3delight shader compiler.            #
# DO NOT EDIT THIS FILE !!!                                                #
############################################################################

# Compiled with 3Delight 10.0.148 linux64 (Jun 17 2013, 3e8a59) "Blade Runner"

%code 7 121
0

1
1
1
1
1
0
1
0
0
1
1
0
0
1
1
1
1
0
1
1
0
0
0
0
0
0
0
0
30
0 12 0
0 1 0.00000000e+00
0 1 1.00000000e+00
0 1 2.00000000e+00
0 4 ""
0 4 "type"
0 4 "user:ShadowMapRendering"
0 4 "photon:shadingmodel"
0 4 "transmission"
0 4 "user:maya_bakepass"
0 4 "diffuse"
0 1 5.00000000e-01
0 4 "maya_gi_shader"
0 4 "effect"
0 4 "Sides"
0 4 "geometry:geometricnormal"
0 4 "Ri:Orientation"
0 4 "outside"
0 4 "__nondiffuse"
0 1 1.00000002e+30
0 4 "light"
0 4 "matte"
0 1 8.00000012e-01
0 4 "bakelight"
0 4 "send:light:do_bake"
0 13 0
0 4 "ComputeGI"
0 4 "lambert1"
0 1 1.57079637e+00
0 10 1
1
"shaderid" "" 2 1 0 0 0 0
0
0
0
0
0
0
0
0


3

1 58 29 

1
3 

0
0

0

0

0

0

2
"surface"
"*opacity"
14
2
3
13
14
6
9
10
4
16
18
19
0
15
1
2
"*Ci" 3 3 0 0 1 0
"*Oi" 3 3 0 0 1 0
0
0

0


0

0


0

15
10 0 0 0
4 0 0 0
4 0 0 0
4 0 0 0
4 0 0 0
13 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
16
10 0 0 0
1 0 0 0
1 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
9 0 0 0
9 0 0 0
9 0 0 0
8 0 0 0
608

4 70 30 
7 60 32 
203 65 33 60 
43 74 65 29 
232 74 0 3 
7 60 32 
234 
1 66 29 
200 65 34 66 
43 74 65 29 
232 74 0 3 
1 66 29 
234 
45 74 60 36 
232 74 1 4 
43 74 66 30 
234 
232 74 0 3 
1 66 30 
233 3 
1 66 29 
234 
1 67 29 
201 65 37 67 
43 74 65 29 
232 74 0 3 
1 67 29 
234 
45 74 60 38 
232 74 1 4 
44 74 67 29 
234 
232 74 0 3 
1 65 30 
233 3 
1 65 29 
234 
44 74 66 29 
232 74 1 4 
43 74 65 29 
234 
232 74 0 3 
1 66 30 
233 3 
1 66 29 
234 
9 71 29 29 29 
9 72 39 39 39 
9 73 29 29 29 
1 65 39 
26 77 72 0 
25 78 77 50 
203 67 33 61 
43 74 30 67 
232 74 0 4 
45 74 61 48 
234 
232 74 0 30 
200 67 35 62 
43 74 30 67 
232 74 0 4 
45 74 62 49 
234 
232 74 0 3 
2 77 78 
234 
9 78 29 29 29 
233 357 
135 86 15 1 
2 88 86 
1 67 31 
200 68 42 67 
43 74 67 31 
232 74 0 4 
139 88 86 4 
233 32 
1 67 30 
200 69 43 67 
43 74 67 29 
232 74 0 16 
200 67 44 63 
45 74 63 45 
232 74 0 3 
40 88 88 
234 
234 
234 
2 87 88 
156 80 
2 79 80 
4 81 29 
1 67 56 
178 59 6 28 0 0 
235 59 62 
177 74 6 88 67 28 
232 74 0 43 
1 75 29 
206 69 46 75 
41 74 75 30 
232 74 0 27 
2 82 19 
135 89 18 1 
37 76 89 88 
25 80 82 76 
20 75 30 75 
25 80 80 75 
19 81 81 80 
234 
234 
179 59 6 28 0 0 
236 -65 
4 82 29 
21 78 30 70 
21 80 30 78 
26 77 77 80 
4 70 47 
78 77 77 71 70 
25 80 81 50 
48 74 78 71 
232 74 0 4 
44 74 66 29 
234 
232 74 0 72 
203 67 33 63 
43 74 30 67 
232 74 0 4 
45 74 63 36 
234 
232 74 1 17 
200 67 34 69 
43 74 30 67 
232 74 0 4 
44 74 69 29 
234 
234 
232 74 0 23 
4 83 29 
135 88 4 1 
37 75 88 86 
73 75 75 
151 75 30 75 65 
25 78 78 75 
233 3 
4 83 29 
234 
233 3 
4 83 29 
234 
4 70 50 
26 81 77 70 
232 57 0 49 
211 64 40 
56 74 64 53 
232 74 0 32 
1 67 29 
213 69 64 41 67 
44 74 67 29 
232 74 0 15 
228 3 64 54 55 85 6 87 81 
2 84 85 
237 3 28 
234 
234 
9 84 29 29 29 
234 
26 81 70 84 
19 80 79 80 
19 80 80 81 
19 79 80 82 
26 77 77 79 
19 79 77 73 
19 77 79 83 
234 
21 79 30 78 
26 3 1 79 
26 2 77 1 
178 59 6 51 1 30 0 52 
235 59 10 
179 59 6 51 1 30 0 52 
236 -13 

180
3 6 10 14 18 21 22 25 29 33 37 40 41 45 49 53 54 58 61 63 
66 67 70 74 78 82 85 86 90 94 98 99 103 106 108 111 112 116 120 124 
125 129 132 134 137 138 143 148 153 156 160 164 168 172 176 180 181 185 189 193 
197 201 202 206 209 210 215 217 221 224 227 231 235 239 243 245 248 252 256 260 
264 268 272 275 276 277 278 281 283 286 289 292 298 301 307 311 314 318 322 326 
329 333 337 341 345 349 353 354 355 361 363 366 370 374 378 381 386 390 394 398 
402 403 407 411 415 419 423 424 428 432 436 440 444 445 446 450 453 457 461 464 
469 473 475 478 479 481 484 485 488 492 496 499 503 507 510 515 519 523 532 535 
538 539 540 545 546 550 554 558 562 566 570 574 575 579 583 587 595 598 606 608 
9
0
15
16
4
6
18
19
3
1
1
"*Oi" 3 3 0 0 1 0
0
0

0


0

12
4 0 0 0
4 0 0 0
4 0 0 0
13 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
9
10 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
3 0 0 0
9 0 0 0
9 0 0 0
9 0 0 0
1 0 0 0
446

4 99 30 
7 90 32 
203 94 33 90 
43 102 94 29 
232 102 0 3 
7 90 32 
234 
1 95 29 
200 94 34 95 
43 102 94 29 
232 102 0 3 
1 95 29 
234 
45 102 90 36 
232 102 1 4 
43 102 95 30 
234 
232 102 0 3 
1 95 30 
233 3 
1 95 29 
234 
1 96 29 
201 94 37 96 
43 102 94 29 
232 102 0 3 
1 96 29 
234 
45 102 90 38 
232 102 1 4 
44 102 96 29 
234 
232 102 0 3 
1 94 30 
233 3 
1 94 29 
234 
44 102 95 29 
232 102 1 4 
43 102 94 29 
234 
232 102 0 3 
1 95 30 
233 3 
1 95 29 
234 
9 100 29 29 29 
9 101 39 39 39 
1 94 39 
26 103 101 0 
203 96 33 91 
43 102 30 96 
232 102 0 4 
45 102 91 48 
234 
232 102 0 5 
9 104 29 29 29 
233 254 
135 107 15 1 
2 109 107 
1 96 31 
200 97 42 96 
43 102 96 31 
232 102 0 4 
139 109 107 4 
233 32 
1 96 30 
200 98 43 96 
43 102 96 29 
232 102 0 16 
200 96 44 92 
45 102 92 45 
232 102 0 3 
40 109 109 
234 
234 
234 
2 108 109 
1 96 56 
178 102 6 28 0 0 
235 102 23 
177 102 6 109 96 28 
232 102 0 4 
206 98 46 110 
234 
179 102 6 28 0 0 
236 -26 
21 104 30 99 
21 105 30 104 
26 103 103 105 
4 99 47 
78 103 103 100 99 
48 102 104 100 
232 102 0 4 
44 102 95 29 
234 
232 102 0 64 
203 96 33 92 
43 102 30 96 
232 102 0 4 
45 102 92 36 
234 
232 102 1 17 
200 96 34 98 
43 102 30 96 
232 102 0 4 
44 102 98 29 
234 
234 
232 102 0 20 
135 109 4 1 
37 110 109 107 
73 110 110 
151 110 30 110 94 
25 104 104 110 
234 
234 
4 99 50 
26 103 103 99 
232 57 0 41 
211 93 40 
56 102 93 53 
232 102 0 29 
1 96 29 
213 98 93 41 96 
44 102 96 29 
232 102 0 12 
228 3 93 54 55 106 6 108 103 
237 3 28 
234 
234 
234 
234 
21 103 30 104 
26 3 1 103 

135
3 6 10 14 18 21 22 25 29 33 37 40 41 45 49 53 54 58 61 63 
66 67 70 74 78 82 85 86 90 94 98 99 103 106 108 111 112 116 120 124 
125 129 132 134 137 138 143 148 151 155 159 163 167 171 172 176 181 183 187 190 
193 197 201 205 209 211 214 218 222 226 230 234 238 241 242 243 244 247 250 256 
259 265 269 273 274 280 282 286 290 294 297 302 306 310 314 315 319 323 327 331 
335 336 340 344 348 352 356 357 358 362 366 370 373 378 382 383 384 387 391 395 
398 402 406 409 414 418 422 431 434 435 436 437 438 442 446 

%comment-3dl 7 121
7
"MacroBlocks_*opacity"
"MTIKMTQgMwogMSAxIDAKIDk1IDEwMgoyOSAzCiAxIDEgMAogOTYgMTAyCjM3IDQKIDIgMCAxCiA5NCA5NSAxMDIKNDYgNAogMSAwIDMKIDAgOTQgMTAwIDEwMwo1OCAzCiAxIDAgMwogMTUgOTYgMTA3IDEwOQo3MiAzCiAxIDEgMAogMTAyIDEwOQo3NyAyCiAxIDAgMgogMTA5IDk2IDEwOAo4NyA5CiAzIDEgMgogOTUgOTkgMTAwIDEwMyAxMDIgMTA0CjEwNCA0CiAyIDAgMQogOTYgOTggMTAyCjEwOSA3CiA0IDEgMAogOTQgMTAyIDEwNyA0IDEwNAoxMTcgMgogMCAxIDAKIDEwMwoxMzMgMgogMiAwIDEKIDEwNCAxIDM="
"MacroBlocks_surface"
"MTUKMTQgMwogMSAxIDAKIDY2IDc0CjI5IDMKIDEgMSAwCiA2NyA3NAozNyA0CiAyIDAgMQogNjUgNjYgNzQKNDYgNgogMSAwIDUKIDAgNjUgNzEgNzMgNzcgNzgKNjMgNAogMSAyIDAKIDc0IDc3IDc4CjY4IDMKIDEgMCAzCiAxNSA2NyA4NiA4OAo4MiAzCiAxIDEgMAogNzQgODgKODkgMwogMSAwIDMKIDgwIDY3IDc5IDgxCjk4IDEwCiA0IDEgMAogNzUgODggMTggMTkgODEKMTExIDExCiA0IDEgNAogNjYgNzAgNzEgODEgNzcgNzQgNzggODAgODIKMTMwIDQKIDIgMCAxCiA2NyA2OSA3NAoxMzUgMTAKIDQgMSAxCiA2NSA3NCA4NiA0IDc4IDgzCjE0OCAyCiAxIDAgMgogNzcgNzAgODEKMTY1IDcKIDcgMSAwCiA3MCA3MyA3OSA4MCA4MiA4MyA4NCA3NwoxNzMgMwogMyAwIDIKIDc3IDc4IDEgMiAz"
"OpCodesForDerivatives_*opacity"
"MAo="
"OpCodesForDerivatives_surface"
"MAo="
"ScopeBlocks_*opacity"
"NwoxNCAyCiAxIDEgMAogOTUgMTAyCjI5IDIKIDEgMSAwCiA5NiAxMDIKMzggMgogMSAxIDAKIDk0IDEwMgo3MiAyCiAwIDEgMAogMTA5CjkzIDIKIDEgMSAwCiA5NSAxMDIKMTA1IDIKIDEgMSAwCiA5OCAxMDIKMTA5IDYKIDMgMSAwCiA5NCAxMDcgNCAxMDQ="
"ScopeBlocks_surface"
"MTAKMTQgMgogMSAxIDAKIDY2IDc0CjI5IDIKIDEgMSAwCiA2NyA3NAozOCAyCiAxIDEgMAogNjUgNzQKNjMgMgogMSAxIDAKIDc4IDc3CjgyIDIKIDAgMSAwCiA4OAo5OSA4CiA0IDEgMAogNzUgODggMTggMTkgODEKMTE5IDIKIDEgMSAwCiA2NiA3NAoxMzEgMgogMSAxIDAKIDY5IDc0CjEzNSA3CiAzIDEgMQogNjUgODYgNCA3OCA4MwoxNDIgMgogMCAwIDEKIDgz"
"source"
"I2xpbmUgMSAiL2F0b21vL3BpcGVsaW5lL3Rvb2xzL3NoYWRlcnMvZGVsaWdodC9zcmMvbGFtYmVydDEuc2wiCnN1cmZhY2UgbGFtYmVydDEoCgl1bmlmb3JtIGZsb2F0IHNoYWRlcmlkID0gMDsKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKKQp7CgoKCWZsb2F0IHNzID0gczsKCWZsb2F0IHR0ID0gMSAtIHQ7CgoKCglmbG9hdCBmbG9hdER1bW15ID0gMC4wOwoJZmxvYXQgZmxvYXQyRHVtbXlbMl0gPSB7MC4wLCAwLjB9OwoJY29sb3IgY29sb3JEdW1teSA9IGNvbG9yKDAsMCwwKTsKCW1hdHJpeCBtYXRyaXhEdW1teSA9IDE7Cglub3JtYWwgbm9ybWFsRHVtbXkgPSBub3JtYWwoMCwwLDApOwoJcG9pbnQgcG9pbnREdW1teSA9IHBvaW50KDAsMCwwKTsKCXZlY3RvciB2ZWN0b3JEdW1teSA9IHZlY3RvcigwLDAsMCk7CglzdHJpbmcgc3RyaW5nRHVtbXk7CgoKCWNvbG9yIF9fdHJhbnNwYXJlbmN5ID0gMTsKCgoKCXVuaWZvcm0gc3RyaW5nIF9fcmF5dHlwZSA9ICIiOwoJaWYocmF5aW5mbyggInR5cGUiLCBfX3JheXR5cGUgKSA9PSAwKQoJewoJCV9fcmF5dHlwZSA9ICIiOwoJfQoKCXVuaWZvcm0gZmxvYXQgX19zaGFkb3dtYXByZW5kZXJpbmcgPSAwOwoJaWYoYXR0cmlidXRlKCJ1c2VyOlNoYWRvd01hcFJlbmRlcmluZyIsIF9fc2hhZG93bWFwcmVuZGVyaW5nKSA9PSAwKQoJewoJCV9fc2hhZG93bWFwcmVuZGVyaW5nID0gMDsKCX0KCgl1bmlmb3JtIGZsb2F0IF9faXNfc2hhZG93X3JheSA9IChfX3JheXR5cGUgPT0gInRyYW5zbWlzc2lvbiIgfHwgX19zaGFkb3dtYXByZW5kZXJpbmcgPT0gMSkgPyAxOjA7CgoJdW5pZm9ybSBmbG9hdCBfX2lzX2Jha2VwYXNzID0gMDsKCWlmKG9wdGlvbigidXNlcjptYXlhX2Jha2VwYXNzIiwgX19pc19iYWtlcGFzcykgPT0gMCkKCXsKCQlfX2lzX2Jha2VwYXNzID0gMDsKCX0KCgl1bmlmb3JtIGZsb2F0IF9faXNfaXJyYWRpYW5jZV9yYXkgPQoJCShfX3JheXR5cGUgPT0gImRpZmZ1c2UiIHx8IF9faXNfYmFrZXBhc3MgIT0gMCkgPyAxOjA7CgoKCgl1bmlmb3JtIGZsb2F0IF9fcmVmbGVjdHMgPSAoX19pc19zaGFkb3dfcmF5PT0wICYmIF9faXNfaXJyYWRpYW5jZV9yYXk9PTApID8gMTowOwoJdW5pZm9ybSBmbG9hdCBfX3JlZnJhY3RzID0gKF9faXNfc2hhZG93X3JheSE9MCB8fCBfX2lzX2lycmFkaWFuY2VfcmF5PT0wKSA/IDE6MDsKCgoKI2xpbmUgMSAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL2xhbWJlcnQuaCIKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCiNsaW5lIDEgIi9hdG9tby9hcHBzL2xpbnV4L3g4Nl82NC9kZWxpZ2h0LzEwLjAuMTQ4L21heWEvcnNsLy91dGlscy5oIgoKCgoKCgoKCgoKCiNsaW5lIDE4ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vdXRpbHMuaCIKZmxvYXQKbHVtaW5hbmNlKCBjb2xvciBpX2NvbG9yICkKewoJcmV0dXJuCgkJMC4zICogY29tcChpX2NvbG9yLCAwKSArIAoJCTAuNTkgKiBjb21wKGlfY29sb3IsIDEpICsgCgkJMC4xMSAqIGNvbXAoaV9jb2xvciwgMik7Cn0KCgpmbG9hdCBDSUVsdW1pbmFuY2UoY29sb3IgYykKewoJcmV0dXJuCgkgICAgICBjb21wKGMsIDApICogMC4yMTI2NzEKCSAgICArIGNvbXAoYywgMSkgKiAwLjcxNTE2MAoJICAgICsgY29tcChjLCAyKSAqIDAuMDcyMTY5Owp9CgoKZmxvYXQgc3EoZmxvYXQgeCkKewoJcmV0dXJuIHggKiB4Owp9Cgpjb2xvcgpjYWJzKCBjb2xvciBpX2NvbG9yICkKewoJcmV0dXJuIGNvbG9yKAoJCWFicyhjb21wKGlfY29sb3IsIDApKSwgYWJzKGNvbXAoaV9jb2xvciwxKSksIGFicyhjb21wKGlfY29sb3IsMikpICk7Cn0KCgpmbG9hdCBmaWx0ZXJlZHB1bHNlIChmbG9hdCBlZGdlMCwgZWRnZTEsIHgsIGR4KQp7CiAgICBmbG9hdCB4MCA9IHggLSBkeC8yOwogICAgZmxvYXQgeDEgPSB4MCArIGR4OwogICAgcmV0dXJuIG1heCAoMCwgKG1pbih4MSxlZGdlMSktbWF4KHgwLGVkZ2UwKSkgLyBkeCk7Cn0KCgpmbG9hdCBmaWx0ZXJlZHB1bHNldHJhaW4gKGZsb2F0IGVkZ2UsIHBlcmlvZCwgeCwgZHgpCnsKCiAgICBmbG9hdCB3ID0gZHgvcGVyaW9kOwogICAgZmxvYXQgeDAgPSB4L3BlcmlvZCAtIHcvMjsKICAgIGZsb2F0IHgxID0geDArdzsKICAgIGZsb2F0IG5lZGdlID0gZWRnZSAvIHBlcmlvZDsKCgogICAgZmxvYXQgaW50ZWdyYWwgKGZsb2F0IHQpIHsgCiAgICAgICAgZXh0ZXJuIGZsb2F0IG5lZGdlOwogICAgICAgIHJldHVybiAoKDEtbmVkZ2UpKmZsb29yKHQpICsgbWF4KDAsdC1mbG9vcih0KS1uZWRnZSkpOwogICAgfQoKCWZsb2F0IHJlc3VsdDsKCWlmKCB4MCA9PSB4MSApCgl7CgoJCXJlc3VsdCA9ICh4MCAtIGZsb29yKHgwKSA8IG5lZGdlKSA/IDAgOiAxOwoJfQoJZWxzZQoJewogICAgCXJlc3VsdCA9IChpbnRlZ3JhbCh4MSkgLSBpbnRlZ3JhbCh4MCkpIC8gdzsKCgoKCgoKI2xpbmUgODcgIi9hdG9tby9hcHBzL2xpbnV4L3g4Nl82NC9kZWxpZ2h0LzEwLjAuMTQ4L21heWEvcnNsLy91dGlscy5oIgoJCWZsb2F0IGV4dGluY3QgPSBzbW9vdGhzdGVwKCAwLjQsIDAuNSwgdyApOwoJCXJlc3VsdCA9IHJlc3VsdCArIGV4dGluY3QgKiAoMSAtIG5lZGdlIC0gcmVzdWx0KTsKCX0KCglyZXR1cm4gcmVzdWx0Owp9CgoKCgojbGluZSA5NyAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3V0aWxzLmgiCmZsb2F0IGJpYXMoZmxvYXQgYiwgeCkKewogICAgcmV0dXJuIHBvdyh4LCBsb2coYikvLTAuNjkzMTQ3MTgwNTU5OTQ1KTsKfQoKdm9pZApjb2xvckJhbGFuY2UoCglvdXRwdXQgY29sb3IgaW9fb3V0Q29sb3I7CglvdXRwdXQgZmxvYXQgaW9fb3V0QWxwaGE7Cgl1bmlmb3JtIGZsb2F0IGlfYWxwaGFJc0x1bWluYW5jZTsKCWZsb2F0IGlfYWxwaGFHYWluOwoJZmxvYXQgaV9hbHBoYU9mZnNldDsKCWNvbG9yIGlfY29sb3JHYWluOwoJY29sb3IgaV9jb2xvck9mZnNldDsKCXVuaWZvcm0gZmxvYXQgaV9pbnZlcnQ7ICkKewoJaWYoaV9pbnZlcnQgIT0gMC4wKQoJewoJCWlvX291dENvbG9yID0gMSAtIGlvX291dENvbG9yOwoJCWlvX291dEFscGhhID0gMSAtIGlvX291dEFscGhhOwoJfQoKCWlmKGlfYWxwaGFJc0x1bWluYW5jZSAhPSAwLjApCgl7CgkJaW9fb3V0QWxwaGEgPSBsdW1pbmFuY2UoIGlvX291dENvbG9yICk7Cgl9CgoJaW9fb3V0Q29sb3IgKj0gaV9jb2xvckdhaW47Cglpb19vdXRDb2xvciArPSBpX2NvbG9yT2Zmc2V0OwoKCWlvX291dEFscGhhICo9IGlfYWxwaGFHYWluOwoJaW9fb3V0QWxwaGEgKz0gaV9hbHBoYU9mZnNldDsKfQkKCgoKI2xpbmUgMTg3ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vbGFtYmVydC5oIgojbGluZSAxICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgoKCgoKCgoKI2xpbmUgMSAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3V0aWxzLmgiCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCiNsaW5lIDEwICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgojbGluZSAxICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vZ2xvYmFsX2lsbHVtaW5hdGlvbi5oIgoKCgoKCgoKCiNsaW5lIDE0ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vZ2xvYmFsX2lsbHVtaW5hdGlvbi5oIgpmbG9hdApnZXRHaUVmZmVjdCgpCnsKCXVuaWZvcm0gZmxvYXQgZWZmZWN0ID0gMDsKCW9wdGlvbiggInVzZXI6XzNkZm1fZ2lfZWZmZWN0IiwgZWZmZWN0ICk7CgoJcmV0dXJuIGVmZmVjdDsKfQoKZmxvYXQgZ2V0R2lBZGRUb0ZpbmFsTWl4KCkKewoJdW5pZm9ybSBmbG9hdCBhZGRfdG9fZmluYWxfbWl4ID0gMDsKCW9wdGlvbiggInVzZXI6XzNkZm1fZ2lfYWRkX3RvX2ZpbmFsX21peCIsIGFkZF90b19maW5hbF9taXggKTsKCglyZXR1cm4gYWRkX3RvX2ZpbmFsX21peDsKfQoKCgoKCmNvbG9yCmdldEdsb2JhbElsbHVtaW5hdGlvbkNvbXBvbmVudHMoCgl2YXJ5aW5nIG5vcm1hbCBpX047Cgl2YXJ5aW5nIGNvbG9yIGlfZ2lfd2VpZ2h0OwoJb3V0cHV0IHZhcnlpbmcgY29sb3Igb192aXNpYmlsaXR5OwoJb3V0cHV0IHZhcnlpbmcgY29sb3Igb19lbnZfZGlmZnVzZTsKCW91dHB1dCB2YXJ5aW5nIGNvbG9yIG9fY29sb3JfYmxlZWRpbmc7KQp7CglleHRlcm4gcG9pbnQgUDsKCXNoYWRlciBnaV9zaGFkZXIgPSBnZXRzaGFkZXIoICJtYXlhX2dpX3NoYWRlciIgKTsKCWlmKCBnaV9zaGFkZXIgIT0gbnVsbCApCgl7CgkJdW5pZm9ybSBmbG9hdCBlZmZlY3QgPSAwOwoJCWdldHZhciggZ2lfc2hhZGVyLCAiZWZmZWN0IiwgZWZmZWN0ICk7CgkJaWYoIGVmZmVjdCAhPSAwICkKCQl7CgkJCXZhcnlpbmcgY29sb3IgZ2kgPSBnaV9zaGFkZXItPkNvbXB1dGVHSSggUCwgaV9OLCBpX2dpX3dlaWdodCApOwoJCQlnZXR2YXIoIGdpX3NoYWRlciwgIm91dF92aXNpYmlsaXR5Iiwgb192aXNpYmlsaXR5ICk7CgkJCWdldHZhciggZ2lfc2hhZGVyLCAib3V0X2Vudmlyb25tZW50X2RpZmZ1c2UiLCBvX2Vudl9kaWZmdXNlICk7CgkJCWdldHZhciggZ2lfc2hhZGVyLCAib3V0X2NvbG9yX2JsZWVkaW5nIiwgb19jb2xvcl9ibGVlZGluZyApOwoJCQlyZXR1cm4gZ2k7CgkJfQoJfQoKCW9fdmlzaWJpbGl0eSA9IDE7CglvX2Vudl9kaWZmdXNlID0gMDsKCW9fY29sb3JfYmxlZWRpbmcgPSAwOwoJcmV0dXJuIGNvbG9yKDApOwp9Cgpjb2xvcgpjb21wdXRlSW5kaXJlY3REaWZmdXNlQW5kR0lBT1ZzKAoJY29sb3IgaV9kaWZmdXNlX2ZhY3RvcjsKCWNvbG9yIGlfc3VyZmFjZV9jb2xvcjsKCWNvbG9yIGlfc3VyZmFjZV90cmFuc3BhcmVuY3k7Cglub3JtYWwgaV9OICkKewoJY29sb3IgZ2lfd2VpZ2h0ID0gaV9zdXJmYWNlX2NvbG9yICogaV9kaWZmdXNlX2ZhY3RvcjsKCgljb2xvciB2aXNpYmlsaXR5OwoJY29sb3IgZW52X2RpZmZ1c2U7Cgljb2xvciBjb2xvcl9ibGVlZGluZzsKCgljb2xvciBnaSA9IGdldEdsb2JhbElsbHVtaW5hdGlvbkNvbXBvbmVudHMoCgkJaV9OLCBnaV93ZWlnaHQsCgkJdmlzaWJpbGl0eSwgZW52X2RpZmZ1c2UsIGNvbG9yX2JsZWVkaW5nICk7CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoJcmV0dXJuIGlfZGlmZnVzZV9mYWN0b3IgKiBnaTsKfQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI2xpbmUgMjY3ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vZ2xvYmFsX2lsbHVtaW5hdGlvbi5oIgpmbG9hdApnZXRHaUVudmlyb25tZW50TWFwUGFyYW1ldGVycygKCW91dHB1dCB1bmlmb3JtIHN0cmluZyBlbnZtYXA7CglvdXRwdXQgdW5pZm9ybSBzdHJpbmcgZW52c3BhY2U7KQp7CgllbnZtYXAgPSAiIjsKCWVudnNwYWNlID0gIiI7CgoJdW5pZm9ybSBmbG9hdCBlbnZtYXBfZm91bmQgPSAKCQlvcHRpb24oICJ1c2VyOl8zZGZtX2dpX2Vudmlyb25tZW50X21hcCIsIGVudm1hcCApOwoJb3B0aW9uKCAidXNlcjpfM2RmbV9naV9lbnZpcm9ubWVudF9zcGFjZSIsIGVudnNwYWNlICk7CgoJcmV0dXJuIGVudm1hcF9mb3VuZDsKfQoKZmxvYXQKZ2V0R2lFbnZpcm9ubWVudFBhcmFtZXRlcnMoCglvdXRwdXQgdW5pZm9ybSBzdHJpbmcgZW52bWFwOwoJb3V0cHV0IHVuaWZvcm0gc3RyaW5nIGVudnNwYWNlOwoJb3V0cHV0IHVuaWZvcm0gZmxvYXQgZW52X2ludGVuc2l0eTsKCW91dHB1dCB1bmlmb3JtIGNvbG9yIGVudl9jb2xvcl9nYWluOwoJb3V0cHV0IHVuaWZvcm0gY29sb3IgZW52X2NvbG9yX29mZnNldDsKCW91dHB1dCB1bmlmb3JtIGZsb2F0IGVudl9zcGVjdWxhcml0eTsgKQp7CgllbnZtYXAgPSAiIjsKCWVudnNwYWNlID0gIiI7CgllbnZfaW50ZW5zaXR5ID0gMS4wOwoJZW52X2NvbG9yX2dhaW4gPSAxLjA7CgllbnZfY29sb3Jfb2Zmc2V0ID0gMC4wOwoJZW52X3NwZWN1bGFyaXR5ID0gMDsKCgl1bmlmb3JtIGZsb2F0IGVudm1hcF9mb3VuZCA9IGdldEdpRW52aXJvbm1lbnRNYXBQYXJhbWV0ZXJzKCBlbnZtYXAsIGVudnNwYWNlICk7CgoJaWYoIGVudm1hcF9mb3VuZCApCgl7CgkJb3B0aW9uKCAidXNlcjpfM2RmbV9naV9lbnZpcm9ubWVudF9pbnRlbnNpdHkiLCBlbnZfaW50ZW5zaXR5ICk7CgkJb3B0aW9uKCAidXNlcjpfM2RmbV9naV9lbnZpcm9ubWVudF9jb2xvcl9nYWluIiwgZW52X2NvbG9yX2dhaW4gKTsKCQlvcHRpb24oICJ1c2VyOl8zZGZtX2dpX2Vudmlyb25tZW50X2NvbG9yX29mZnNldCIsIGVudl9jb2xvcl9vZmZzZXQgKTsKCQlvcHRpb24oICJ1c2VyOl8zZGZtX2dpX2Vudmlyb25tZW50X3NwZWN1bGFyaXR5IiwgZW52X3NwZWN1bGFyaXR5ICk7Cgl9CgoJcmV0dXJuIGVudm1hcF9mb3VuZDsKfQoKCgoKY29sb3IgZ2V0R2lFbnZpcm9ubWVudFNwZWN1bGFyKAoJdmVjdG9yIGlfZGlyOyAKCXVuaWZvcm0gZmxvYXQgaV9zYW1wbGVzOyAKCXVuaWZvcm0gZmxvYXQgaV9ibHVyKQp7Cgljb2xvciBlbnZfY29sb3IgPSAwOwoKCXVuaWZvcm0gc3RyaW5nIGVudm1hcCA9ICIiOwoJdW5pZm9ybSBzdHJpbmcgZW52c3BhY2UgPSAiIjsKCXVuaWZvcm0gZmxvYXQgZW52X2ludGVuc2l0eSA9IDEuMDsKCXVuaWZvcm0gY29sb3IgZW52X2NvbG9yX2dhaW4gPSAxLjA7Cgl1bmlmb3JtIGNvbG9yIGVudl9jb2xvcl9vZmZzZXQgPSAwLjA7Cgl1bmlmb3JtIGZsb2F0IGVudl9zcGVjdWxhcml0eSA9IDA7Cgl1bmlmb3JtIGZsb2F0IGVudm1hcF9mb3VuZCA9IGdldEdpRW52aXJvbm1lbnRQYXJhbWV0ZXJzKCBlbnZtYXAsIGVudnNwYWNlLCAKCQllbnZfaW50ZW5zaXR5LCBlbnZfY29sb3JfZ2FpbiwgZW52X2NvbG9yX29mZnNldCwgZW52X3NwZWN1bGFyaXR5ICk7CgoJaWYoIGVudm1hcF9mb3VuZCAhPSAwICYmIGVudl9zcGVjdWxhcml0eSA+IDAgKQoJewoJCXZlY3RvciBkaXIgPSBpX2RpcjsKCgkJaWYoIGVudnNwYWNlICE9ICIiICkKCQkJZGlyID0gdHJhbnNmb3JtKCBlbnZzcGFjZSwgaV9kaXIgKTsKCgkJZW52X2NvbG9yID0gZW52aXJvbm1lbnQoCgkJCWVudm1hcCwgZGlyLCBkaXIsIGRpciwgZGlyLCAKCQkJInNhbXBsZXMiLCBpX3NhbXBsZXMsICJibHVyIiwgaV9ibHVyKTsKCgkJZW52X2NvbG9yID0gZW52X2NvbG9yICogZW52X2NvbG9yX2dhaW4gKyBlbnZfY29sb3Jfb2Zmc2V0OwoJCWVudl9jb2xvciAqPSBlbnZfaW50ZW5zaXR5ICogZW52X3NwZWN1bGFyaXR5OwoJfQoKCXJldHVybiBlbnZfY29sb3I7Cn0KCgoKI2xpbmUgMTEgIi9hdG9tby9hcHBzL2xpbnV4L3g4Nl82NC9kZWxpZ2h0LzEwLjAuMTQ4L21heWEvcnNsLy9zaGFkaW5nX3V0aWxzLmgiCgoKCgoKCgoKCgoKCgojbGluZSAyOCAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3NoYWRpbmdfdXRpbHMuaCIKbm9ybWFsIFNoYWRpbmdOb3JtYWwoIG5vcm1hbCBpX04gKQp7CglleHRlcm4gdmVjdG9yIEk7Cglub3JtYWwgTmYgPSBpX047CgoJdW5pZm9ybSBmbG9hdCBzaWRlcyA9IDI7CglhdHRyaWJ1dGUoIlNpZGVzIiwgc2lkZXMpOwoKCWlmKCBzaWRlcyA9PSAyICkKCXsKCQlOZiA9IGZhY2Vmb3J3YXJkKE5mLCBJKTsKCX0KCWVsc2UKCXsKCgojbGluZSA0NCAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3NoYWRpbmdfdXRpbHMuaCIKCQl1bmlmb3JtIGZsb2F0IGdlb21ldHJpY25vcm1hbCA9IDE7CgkJYXR0cmlidXRlKCAiZ2VvbWV0cnk6Z2VvbWV0cmljbm9ybWFsIiwgZ2VvbWV0cmljbm9ybWFsICk7CgoJCWlmKCBnZW9tZXRyaWNub3JtYWwgPT0gMCApCgkJewoJCQl1bmlmb3JtIHN0cmluZyBvcmllbnRhdGlvbjsKCQkJYXR0cmlidXRlKCAiUmk6T3JpZW50YXRpb24iLCBvcmllbnRhdGlvbiApOwoJCQlpZiggb3JpZW50YXRpb24gPT0gIm91dHNpZGUiICkKCQkJCU5mID0gLU5mOwoJCX0KCX0KCglyZXR1cm4gTmY7Cn0KCgoKCiNsaW5lIDYyICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgpjb2xvciBnZXRBbWJpZW50KCBub3JtYWwgaV9OOyApCnsKCXJldHVybiBhbWJpZW50KCk7Cn0KCmNvbG9yIGdldEFtYmllbnRVbnNoYWRvd2VkKCBub3JtYWwgaV9OICkKewoJZXh0ZXJuIHBvaW50IFA7Cgljb2xvciBhbWIgPSAwOwoKCWlsbHVtaW5hbmNlKCBQICkKCXsKCQlpZiggTCA9PSAwICkKCQl7CgkJCWNvbG9yIHVuc2hhZG93ZWRfY2wgPSAwOwoJCQlsaWdodHNvdXJjZSgiX18zZGZtX3Vuc2hhZG93ZWRfY2wiLCB1bnNoYWRvd2VkX2NsKTsKCQkJYW1iICs9IHVuc2hhZG93ZWRfY2w7CgkJfQoJfQoKCXJldHVybiBhbWI7Cn0KCgoKCiNsaW5lIDg4ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgpjb2xvciBnZXREaWZmdXNlKAoJbm9ybWFsIGlfTjsKCXVuaWZvcm0gZmxvYXQga2V5TGlnaHRzT25seTsKCXVuaWZvcm0gZmxvYXQgdW5zaGFkb3dlZDsgKQp7CglleHRlcm4gcG9pbnQgUDsKCWNvbG9yIEMgPSAwOwoKCWlsbHVtaW5hbmNlKCBQLCBpX04sIFBJLzIgKQoJewoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOwoKCQlpZigga2V5TGlnaHRzT25seSAhPSAwICkKCQl7CgkJCWlzS2V5TGlnaHQgPSAwOwoJCQlsaWdodHNvdXJjZSggImlza2V5bGlnaHQiLCBpc0tleUxpZ2h0ICk7CgkJfQoKCQlpZiggaXNLZXlMaWdodCAhPSAwICkKCQl7CgkJCWZsb2F0IG5vbmRpZmZ1c2UgPSAwOwoJCQlsaWdodHNvdXJjZSggIl9fbm9uZGlmZnVzZSIsIG5vbmRpZmZ1c2UgKTsKCgkJCWlmKCBub25kaWZmdXNlIDwgMSApCgkJCXsKCQkJCXZhcnlpbmcgY29sb3IgY3VyX2NsOwoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07CgkJCQlDICs9IGN1cl9jbCAqIG5vcm1hbGl6ZShMKS5pX04gKiAoMS1ub25kaWZmdXNlKTsKCQkJfQoJCX0KCX0KCglyZXR1cm4gQzsKfQoKY29sb3IgZ2V0VHJhbnNsdWNlbmNlKAoJbm9ybWFsIGlfTjsKCWZsb2F0IGlfdHJhbnNsdWNlbmNlLCBpX3RyYW5zbHVjZW5jZURlcHRoLCBpX3RyYW5zbHVjZW5jZUZvY3VzOykKewoJZXh0ZXJuIHBvaW50IFA7CglleHRlcm4gdmVjdG9yIEk7CgoKCgoKI2xpbmUgMTM0ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgogCWZsb2F0IGZvY3VzID0gbWluKCBpX3RyYW5zbHVjZW5jZUZvY3VzLCAwLjk5OTk5ICk7CgoJY29sb3IgQyA9IDA7CgoJaWYoIGlfdHJhbnNsdWNlbmNlID4gMC4wICkKCXsKCQlpbGx1bWluYW5jZSggUCApCgkJewoJCQlmbG9hdCBub25kaWZmdXNlID0gMDsKCQkJbGlnaHRzb3VyY2UoICJfX25vbmRpZmZ1c2UiLCBub25kaWZmdXNlICk7CgoJCQlpZiggbm9uZGlmZnVzZSA8IDEgKQoJCQl7CgkJCQlmbG9hdCBjb3N0aGV0YSA9IG5vcm1hbGl6ZShMKS5ub3JtYWxpemUoSSk7CiAJCQkJZmxvYXQgYSA9ICgxICsgY29zdGhldGEpICogMC41OwoKIAkJCQlmbG9hdCB0cnMgPSBwb3coIHBvdyhhLCBmb2N1cyksIDEvKDEtZm9jdXMpICk7CgogIAkJCQlDICs9IENsICogdHJzICogKDEtbm9uZGlmZnVzZSk7CgkJCX0KCQl9Cgl9CgoJcmV0dXJuIEMgKiBpX3RyYW5zbHVjZW5jZTsKfQoKY29sb3IKZ2V0Qmxpbm4oIAoJCW5vcm1hbCBpX05mOwoJCWZsb2F0IGlfZWNjZW50cmljaXR5OwoJCWZsb2F0IGlfc3BlY3VsYXJSb2xsT2ZmOwoJCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5OwoJCXVuaWZvcm0gZmxvYXQgdW5zaGFkb3dlZDsKCQkpCnsKCWZsb2F0IEU7Cgljb2xvciBDID0gMDsKCXZlY3RvciBILCBMbiwgViwgTm47CglmbG9hdCBOSCwgTkgyLCBOSFNRUiwgRGQsIEdnLCBWTiwgVkgsIExOLCBGZiwgdG1wOwoJZXh0ZXJuIHBvaW50IFA7CglleHRlcm4gdmVjdG9yIEwsIEk7CglleHRlcm4gY29sb3IgQ2w7CgoJaWYoaV9lY2NlbnRyaWNpdHkgIT0gMSkKCQlFID0gMSAvICgoIChpX2VjY2VudHJpY2l0eSkgKiAoaV9lY2NlbnRyaWNpdHkpICkgLSAxKTsKCWVsc2UKCQlFID0gLTFlNTsKCglWID0gbm9ybWFsaXplKC1JKTsKCVZOID0gViAuIGlfTmY7CgoJaWxsdW1pbmFuY2UoIFAsIGlfTmYsIFBJIC8gMikKCXsKCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsKCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkKCQl7CgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsKCQl9CgoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQoJCXsKCQkJZmxvYXQgbm9uc3BlY3VsYXIgPSAwOwoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOwoKCQkJaWYoIG5vbnNwZWN1bGFyIDwgMSApCgkJCXsKCQkJCUxuID0gbm9ybWFsaXplKEwpOwoJCQkJSCA9IG5vcm1hbGl6ZShMbiArIFYpOwoJCQkJTkggPSBpX05mIC4gSDsKCQkJCU5IU1FSID0gKCAoTkgpICogKE5IKSApOwoJCQkJTkgyID0gTkggKiAyOwoJCQkJRGQgPSAoRSArIDEpIC8gKE5IU1FSICsgRSk7CgkJCQlEZCAqPSBEZDsKCQkJCVZIID0gViAuIEg7CgkJCQlMTiA9IExuIC4gaV9OZjsKCQkJCWlmKFZOIDwgTE4pCgkJCQl7CgkJCQkJaWYoVk4gKiBOSDIgPCBWSCkKCQkJCQkJR2cgPSBOSDIgLyBWSDsKCQkJCQllbHNlCgkJCQkJCUdnID0gMSAvIFZOOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCWlmKExOICogTkgyIDwgVkgpCgkJCQkJCUdnID0gKExOICogTkgyKSAvIChWSCAqIFZOKTsKCQkJCQllbHNlCgkJCQkJCUdnID0gMSAvIFZOOwoJCQkJfQoKCQkJCXRtcCA9IHBvdygoMSAtIFZIKSwgMyk7CgkJCQlGZiA9IHRtcCArICgxIC0gdG1wKSAqIGlfc3BlY3VsYXJSb2xsT2ZmOwoKCQkJCXZhcnlpbmcgY29sb3IgY3VyX2NsOwoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07CgkJCQlDICs9IGN1cl9jbCAqIERkICogR2cgKiBGZiAqICgxLW5vbnNwZWN1bGFyKTsKCQkJfQoJCX0KCX0KCXJldHVybiBDOwp9Cgpjb2xvciBnZXRBbmlzb3Ryb3BpYygKCQl2ZWN0b3IgaV9OLCBpX0ksIGlfeGRpcjsKCQlmbG9hdCBpX2ZyZXNuZWwsIGlfcm91Z2huZXNzLCBpX3NwcmVhZHgsIGlfc3ByZWFkeTsKCQl1bmlmb3JtIGZsb2F0IGlfa2V5TGlnaHRzT25seSwgdW5zaGFkb3dlZDspCnsKCglmbG9hdCBzdGFtX2FuaXNvdHJvcHkoIGZsb2F0IHUsIHYsIHcsIHJ4LCByeSApCgl7CgkJZmxvYXQgdzIgPSB3ICogdzsKCQlmbG9hdCBidCA9IDQgKiBQSSAqIHcyICogdzIgKiByeCAqIHJ5OwoJCWZsb2F0IGV4ID0gZXhwKC0gdSAqIHUgLyAoNCAqIHcyICogcnggKiByeCkpICogZXhwKCAtIHYgKiB2IC8gKDQgKiB3MiAqIHJ5ICogcnkpKTsKCgkJcmV0dXJuIGV4IC8gYnQ7Cgl9CgoJZXh0ZXJuIHBvaW50IFA7Cgl2ZWN0b3IgeWRpciAgPSBpX04gXiBpX3hkaXI7CgoJZmxvYXQgY29zdGhldGEyID0gaV9JLmlfTjsKCgoKCWZsb2F0IHJ4ID0gaV9yb3VnaG5lc3MgLyBpX3NwcmVhZHg7CglmbG9hdCByeSA9IGlfcm91Z2huZXNzIC8gaV9zcHJlYWR5OwoKCWZsb2F0IGV4aXN0cywgZW1pdHNwZWMgPSAwOwoJY29sb3IgQ2xub1NoYWRvdyA9IDA7Cgljb2xvciBzcGVjID0gMDsKCglpbGx1bWluYW5jZSggUCwgaV9OLCBQSSAvIDIgKQoJewoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOwoKCQlpZiggaV9rZXlMaWdodHNPbmx5ICE9IDAgKQoJCXsKCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOwoJCX0KCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApCgkJewoJCQlmbG9hdCBub25zcGVjdWxhciA9IDA7CgkJCWxpZ2h0c291cmNlKCAiX19ub25zcGVjdWxhciIsIG5vbnNwZWN1bGFyICk7CgoJCQlpZiggbm9uc3BlY3VsYXI8MSAmJiBpX04uTD4wICkKCQkJewoJCQkJdmVjdG9yIExuID0gbm9ybWFsaXplKEwpOwoKCQkJCWZsb2F0IGNvc3RoZXRhMSA9IExuLmlfTjsKCQkJCXZlY3RvciBWID0gTG4gKyBpX0k7CgoJCQkJZmxvYXQgdiA9IFYuaV94ZGlyOwoJCQkJZmxvYXQgdSA9IFYueWRpcjsKCQkJCWZsb2F0IHcgPSBWLmlfTjsKCgkJCQlmbG9hdCBHID0gKDEgKyBMbi5pX0kpOwoJCQkJRyA9IGNsYW1wKCBHICogRyAvIChjb3N0aGV0YTEqY29zdGhldGEyKSwgMCwgMSk7CgoJCQkJZmxvYXQgRCA9IHN0YW1fYW5pc290cm9weSggdSwgdiwgdywgcngsIHJ5ICk7CgoJCQkJZmxvYXQgZmFjdG9yID0gIEcgKiBEOwoJCQkJZmxvYXQgSGRvdEkgPSBWLmlfSSAvIGxlbmd0aChWKTsKCQkJCUhkb3RJID0gMS4wIC0gSGRvdEk7CgkJCQlIZG90SSA9IEhkb3RJICogSGRvdEkgKiBIZG90STsKCQkJCWZhY3RvciAqPSBIZG90SSArICgxLjAgLSBIZG90SSk7CgkJCQlmYWN0b3IgPSBjbGFtcChmYWN0b3IsIDAsIDEpICogaV9mcmVzbmVsOwoKCQkJCXZhcnlpbmcgY29sb3IgY3VyX2NsOwoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07CgkJCQlzcGVjICs9IGZhY3RvciAqIGN1cl9jbCAqICgxLW5vbnNwZWN1bGFyKTsKCQkJfQoJCX0KCX0KCXJldHVybiAgc3BlYy80OyAgICAKfQoKdm9pZApjb21wdXRlU3VyZmFjZVRyYW5zcGFyZW5jeSgKCWZsb2F0IGlfbWF0dGVPcGFjaXR5TW9kZTsKCWZsb2F0IGlfbWF0dGVPcGFjaXR5OwoJY29sb3IgaV90cmFuc3BhcmVuY3k7CglvdXRwdXQgY29sb3Igb19vdXRUcmFuc3BhcmVuY3kgKQp7CglpZihpX21hdHRlT3BhY2l0eU1vZGUgPT0gMCkKCXsKCgkJb19vdXRUcmFuc3BhcmVuY3kgPSAwOwoJfQoJZWxzZSBpZihpX21hdHRlT3BhY2l0eU1vZGUgPT0gMSkKCXsKCgkJb19vdXRUcmFuc3BhcmVuY3kgPSBpX21hdHRlT3BhY2l0eTsKCX0KCWVsc2UKCXsKCgkJb19vdXRUcmFuc3BhcmVuY3kgPSAoMSAtIGlfdHJhbnNwYXJlbmN5KSAqIGlfbWF0dGVPcGFjaXR5OwoJfQoKCW9fb3V0VHJhbnNwYXJlbmN5ID0gMS4wIC0gb19vdXRUcmFuc3BhcmVuY3k7Cn0KCnZvaWQgY29tcHV0ZVN1cmZhY2UoCgljb2xvciBpX3N1cmZhY2VDb2xvcjsKCWNvbG9yIGlfdHJhbnNwYXJlbmN5OwoJZmxvYXQgaV9tYXR0ZU9wYWNpdHlNb2RlOwoJZmxvYXQgaV9tYXR0ZU9wYWNpdHk7CglvdXRwdXQgY29sb3Igb19vdXRDb2xvcjsKCW91dHB1dCBjb2xvciBvX291dFRyYW5zcGFyZW5jeTsKCSkKewoJY29tcHV0ZVN1cmZhY2VUcmFuc3BhcmVuY3koCgkJaV9tYXR0ZU9wYWNpdHlNb2RlLCBpX21hdHRlT3BhY2l0eSwgaV90cmFuc3BhcmVuY3ksIG9fb3V0VHJhbnNwYXJlbmN5ICk7CgoJb19vdXRDb2xvciA9IGlfc3VyZmFjZUNvbG9yICogKDEgLSBvX291dFRyYW5zcGFyZW5jeSk7CglvX291dENvbG9yID0gY2xhbXAob19vdXRDb2xvciwgMCwgMWUzMCk7Cn0KCmZsb2F0IHJheVNwZWN1bGFyRGVwdGgoKQp7Cgl1bmlmb3JtIGZsb2F0IGRlcHRoID0gMDsKCXJheWluZm8oICJzcGVjdWxhcmRlcHRoIiwgZGVwdGggKTsKCXJldHVybiBkZXB0aDsKfQoKY29sb3IgZ2V0UmVmbGVjdGlvbigKCW5vcm1hbCBpX047Cgl2ZWN0b3IgaV9JOwoJY29sb3IgaV9zcGVjdWxhckNvbG9yOwoJZmxvYXQgaV9yZWZsZWN0aXZpdHk7Cgljb2xvciBpX3JlZmxlY3RlZENvbG9yOwoJdW5pZm9ybSBmbG9hdCBpX21heERpc3RhbmNlOwoJdW5pZm9ybSBmbG9hdCBpX3NhbXBsZXM7Cgl1bmlmb3JtIGZsb2F0IGlfYmx1cjsKCXVuaWZvcm0gZmxvYXQgaV9ub2lzZUFtcDsKCXVuaWZvcm0gZmxvYXQgaV9ub2lzZUZyZXE7Cgl1bmlmb3JtIGZsb2F0IGlfcmVmbGVjdGlvbkxpbWl0ICkKewoJZXh0ZXJuIHBvaW50IFA7CglleHRlcm4gdW5pZm9ybSBmbG9hdCBfX3JlZmxlY3RzOwoKCgoKCiNsaW5lIDM4NSAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3NoYWRpbmdfdXRpbHMuaCIKCWNvbG9yIHJheV9jb2xvcmF0aW9uID0gaV9zcGVjdWxhckNvbG9yICogaV9yZWZsZWN0aXZpdHk7CgoKCWNvbG9yIGVudl9jb2xvciA9IGlfcmVmbGVjdGVkQ29sb3I7CgoJY29sb3IgcmVmbGVjdGVkID0gZW52X2NvbG9yOwoKCWlmKCByYXlfY29sb3JhdGlvbiAhPSBjb2xvcigwKSAmJgoJICAgIHJheVNwZWN1bGFyRGVwdGgoKSA8IGlfcmVmbGVjdGlvbkxpbWl0ICYmCgkgICAgX19yZWZsZWN0cyAhPSAwKQoJewoJCXZlY3RvciBSID0gcmVmbGVjdCggaV9JLCBpX04gKTsKCgkJaWYoIGlfbm9pc2VBbXAgIT0gMCAmJiBpX25vaXNlRnJlcSAhPSAwKQoJCXsKCQkJcG9pbnQgUG9iaiA9IHRyYW5zZm9ybSgib2JqZWN0IiwgUCk7CgkJCVIgPSBtaXgoIFIsIFIgKiBub2lzZSggUG9iaiAqIGlfbm9pc2VGcmVxICksIGlfbm9pc2VBbXAgKTsKCQl9CgoJCWNvbG9yIHRyczsKCQljb2xvciByYyA9IHRyYWNlKAoJCQkJUCwgUiwKCQkJCSJzdWJzZXQiLCAiLV8zZGZtX25vdF92aXNpYmxlX2luX3JlZmxlY3Rpb25zIiwKCQkJCSJtYXhkaXN0IiwgaV9tYXhEaXN0YW5jZSwKCQkJCSJzYW1wbGVjb25lIiwgaV9ibHVyLAoJCQkJInNhbXBsZXMiLCBpX3NhbXBsZXMsCgkJCQkidHJhbnNtaXNzaW9uIiwgdHJzLAoJCQkJIndlaWdodCIsIHJheV9jb2xvcmF0aW9uICk7CgoKCgoKCgoKCgoJCWlmKCB0cnMgIT0gMCApCgkJewoJCQl2YXJ5aW5nIGNvbG9yIGdpX2Vudl9jb2xvciA9IGdldEdpRW52aXJvbm1lbnRTcGVjdWxhcihSLCBpX3NhbXBsZXMsIGlfYmx1cik7CgoKCgoKCgoKCgkJCXVuaWZvcm0gZmxvYXQgYWRkX3RvX2ZpbmFsX21peCA9IGdldEdpQWRkVG9GaW5hbE1peCgpOwoJCQlpZiggYWRkX3RvX2ZpbmFsX21peCA+IDAgKQoJCQl7CgkJCQlyZWZsZWN0ZWQgKz0gZ2lfZW52X2NvbG9yOwoJCQl9CgoKCgoJCX0KCgoKCgkJcmVmbGVjdGVkICo9IHRyczsKCQlyZWZsZWN0ZWQgKz0gcmM7Cgl9CgoKCgoKCgoKCgoKCXJldHVybiByZWZsZWN0ZWQgKiByYXlfY29sb3JhdGlvbjsKfQoKZmxvYXQgZG9SZWZyYWN0aW9uKAoJbm9ybWFsIGlfTjsKCXZlY3RvciBpX0k7Cgl1bmlmb3JtIGZsb2F0IGlfcmVmcmFjdGlvbnM7CglmbG9hdCBpX3JlZnJhY3RpdmVJbmRleDsKCXVuaWZvcm0gZmxvYXQgaV9yZWZyYWN0aW9uTGltaXQ7CglmbG9hdCBpX2xpZ2h0QWJzb3JiYW5jZTsKCWZsb2F0IGlfc2hhZG93QXR0ZW51YXRpb247CglvdXRwdXQgY29sb3IgaW9fdHJhbnNwYXJlbmN5OwoJb3V0cHV0IGNvbG9yIG9fcmVmcmFjdGlvbjsgKQp7CgoKCglleHRlcm4gcG9pbnQgUDsKCXVuaWZvcm0gc3RyaW5nIHJheVR5cGU7Cgl1bmlmb3JtIGZsb2F0IGlzU2hhZG93TWFwOwoJZXh0ZXJuIHVuaWZvcm0gZmxvYXQgX19yZWZyYWN0czsKCglmbG9hdCB0aXIgPSAwOwoJaWYoIGlvX3RyYW5zcGFyZW5jeSAhPSBjb2xvcigwKSAmJgoJICAgIF9fcmVmcmFjdHMgIT0gMCkKCXsKCgoKCiNsaW5lIDQ5MyAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3NoYWRpbmdfdXRpbHMuaCIKCQlpZiggKDEgPT0gcmF5aW5mbyggInR5cGUiLCByYXlUeXBlICkgJiYgcmF5VHlwZSA9PSAidHJhbnNtaXNzaW9uIikgfHwKCQkJKDEgPT0gYXR0cmlidXRlKCAidXNlcjpTaGFkb3dNYXBSZW5kZXJpbmciLCBpc1NoYWRvd01hcCApICYmCgkJCSBpc1NoYWRvd01hcCAhPSAwKSApCgkJewoJCQlvX3JlZnJhY3Rpb24gPSAwOwoJCQlpb190cmFuc3BhcmVuY3kgKj0KCQkJCW1peCggMSwgYWJzKCBub3JtYWxpemUoaV9JKSAuIGlfTiApLCBpX3NoYWRvd0F0dGVudWF0aW9uICk7CgkJfQoJCWVsc2UgaWYoIGlfcmVmcmFjdGlvbnMgIT0gMCApCgkJewoJCQljb2xvciByZWZyYWN0aW9uQ29sb3IgPSAwOwoKCQkJaWYoIHJheVNwZWN1bGFyRGVwdGgoKSA8IGlfcmVmcmFjdGlvbkxpbWl0ICkKCQkJewoJCQkJZmxvYXQgZXRhOwoJCQkJbm9ybWFsIE5mID0gaV9OOwoKCQkJCWlmKCBpX0kgLiBpX04gPCAwICkKCQkJCXsKCQkJCQlldGEgPSAxLjAgLyBpX3JlZnJhY3RpdmVJbmRleDsKCQkJCQlOZiA9IGlfTjsKCQkJCX0gCgkJCQllbHNlIAoJCQkJewoJCQkJCWV0YSA9IGlfcmVmcmFjdGl2ZUluZGV4OwoJCQkJCU5mID0gLWlfTjsKCQkJCX0KCgkJCQl2ZWN0b3IgcmVmcmFjdCA9IHJlZnJhY3Qobm9ybWFsaXplKGlfSSksIE5mLCBldGEpOwoKCQkJCWlmKCBsZW5ndGgoIHJlZnJhY3QgKSA8PSAxZS02ICkKCQkJCXsKCQkJCQlvX3JlZnJhY3Rpb24gPSAwOwoJCQkJCXRpciA9IDEuMDsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQljb2xvciB0cnMgPSAwOwoJCQkJCXZlY3RvciBkaXIgPSBub3JtYWxpemUocmVmcmFjdCk7CgoJCQkJCXJlZnJhY3Rpb25Db2xvciA9IHRyYWNlKAoJCQkJCQkJUCwgZGlyLAoJCQkJCQkJInN1YnNldCIsICItXzNkZm1fbm90X3Zpc2libGVfaW5fcmVmcmFjdGlvbnMiLCAKCQkJCQkJCSJ0cmFuc21pc3Npb24iLCB0cnMpOwoKCQkJCQl1bmlmb3JtIGZsb2F0IGFkZF90b19maW5hbF9taXggPSBnZXRHaUFkZFRvRmluYWxNaXgoKTsKCQkJCQlpZiggdHJzICE9IDAgJiYgYWRkX3RvX2ZpbmFsX21peCA+IDApCgkJCQkJewoJCQkJCQlyZWZyYWN0aW9uQ29sb3IgKz0gZ2V0R2lFbnZpcm9ubWVudFNwZWN1bGFyKGRpciwgMCwgMCkgKiB0cnM7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlvX3JlZnJhY3Rpb24gPSBpb190cmFuc3BhcmVuY3kgKiByZWZyYWN0aW9uQ29sb3I7CgkJCWlvX3RyYW5zcGFyZW5jeSA9IDA7CgkJfQoJCWVsc2UKCQl7CgkJCW9fcmVmcmFjdGlvbiA9IDA7CgkJfQoJfQoJZWxzZQoJewoJCW9fcmVmcmFjdGlvbiA9IDA7Cgl9CgoJcmV0dXJuIHRpcjsKfQoKZmxvYXQgY29tcHV0ZVNoYWRvd1ZhbHVlKG5vcm1hbCBpX04pCnsKCWZsb2F0IHNoYWRvd1ZhbHVlID0gMDsKCXZhcnlpbmcgZmxvYXQgdG90YWxMaWdodEludGVuc2l0eSA9IDA7CgoJZXh0ZXJuIHZhcnlpbmcgcG9pbnQgUDsKCWlsbHVtaW5hbmNlKFApCgl7CgoKI2xpbmUgNTcyICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgoJCWlmKCBMLmlfTiA+PSAwICkKCQl7CgkJCWZsb2F0IF9fM2RmbV9zaGFkb3dpbmcgPSAwOwoJCQljb2xvciBfXzNkZm1fdW5zaGFkb3dlZF9jbCA9IDA7CgoJCQlsaWdodHNvdXJjZSgiX18zZGZtX3NoYWRvd2luZyIsIF9fM2RmbV9zaGFkb3dpbmcpOwoJCQlsaWdodHNvdXJjZSgiX18zZGZtX3Vuc2hhZG93ZWRfY2wiLCBfXzNkZm1fdW5zaGFkb3dlZF9jbCk7CgkJCWZsb2F0IHVuc2hhZG93ZWRfaW50ZW5zaXR5ID0gbHVtaW5hbmNlKF9fM2RmbV91bnNoYWRvd2VkX2NsKTsKCgkJCXNoYWRvd1ZhbHVlICs9IF9fM2RmbV9zaGFkb3dpbmcgKiB1bnNoYWRvd2VkX2ludGVuc2l0eTsKCQkJdG90YWxMaWdodEludGVuc2l0eSArPSB1bnNoYWRvd2VkX2ludGVuc2l0eTsKCQl9Cgl9CgoJc2hhZG93VmFsdWUgLz0gdG90YWxMaWdodEludGVuc2l0eTsKICByZXR1cm4gc2hhZG93VmFsdWU7Cn0KCnZvaWQgY29tcHV0ZVNoYWRvd1Bhc3Mobm9ybWFsIGlfTikKewoKCgoKfQoKY29sb3IgY29tcHV0ZUx1bWluYW5jZURlcHRoKCkKewoJdW5pZm9ybSBmbG9hdCBuZWFyX2ZhclsyXSA9IHswLCAxZTN9OwoJb3B0aW9uKCAiQ2xpcHBpbmciLCBuZWFyX2ZhciApOwoKCXVuaWZvcm0gZmxvYXQgbmVhciA9IG5lYXJfZmFyWzBdOwoJdW5pZm9ybSBmbG9hdCBmYXIgPSBuZWFyX2ZhclsxXTsKCglleHRlcm4gdmFyeWluZyB2ZWN0b3IgSTsKCWZsb2F0IGRlcHRoID0gbGVuZ3RoKEkpIC0gbmVhcjsKCglmYXIgLT0gbmVhcjsKCWRlcHRoID0gKGZhciAtIGRlcHRoKSAvIGZhcjsKCglyZXR1cm4gY29sb3IoZGVwdGgsIGRlcHRoLCBkZXB0aCk7Cn0KCmNvbG9yIGdldFBob25nKAoJbm9ybWFsIGlfTjsgdmVjdG9yIGlfVjsgZmxvYXQgaV9zaXplOyAKCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQp7Cgljb2xvciBDID0gMDsKCXZlY3RvciBSID0gcmVmbGVjdCggLW5vcm1hbGl6ZShpX1YpLCBub3JtYWxpemUoaV9OKSApOwoJZXh0ZXJuIHZhcnlpbmcgcG9pbnQgUDsKCglpbGx1bWluYW5jZSggUCwgaV9OLCBQSS8yICkKCXsKCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsKCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkKCQl7CgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsKCQl9CgoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQoJCXsKCQkJZmxvYXQgbm9uc3BlY3VsYXIgPSAwOwoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOwoKCQkJaWYoIG5vbnNwZWN1bGFyIDwgMSApCgkJCXsKCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsKCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsKCQkJCXsgY3VyX2NsID0gQ2w7IGlmKCB1bnNoYWRvd2VkICE9IDAgKSBsaWdodHNvdXJjZSgiX18zZGZtX3Vuc2hhZG93ZWRfY2wiLCBjdXJfY2wpOyB9OwoJCQkJQyArPSBjdXJfY2wgKiBwb3cobWF4KDAuMCxSLkxuKSwgaV9zaXplKSAqICgxLW5vbnNwZWN1bGFyKTsKCQkJfQoJCX0KCX0KCXJldHVybiBDOwp9CgoKY29sb3IgZ2V0UGhvbmdTKAoJbm9ybWFsIGlfTjsgdmVjdG9yIGlfVjsgZmxvYXQgaV9zaXplOyAKCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQp7Cgljb2xvciBDID0gMDsKCWV4dGVybiB2YXJ5aW5nIHBvaW50IFA7CgoJaWxsdW1pbmFuY2UoIFAsIGlfTiwgUEkvMiApCgl7CgkJdmVjdG9yIEggPSBub3JtYWxpemUobm9ybWFsaXplKEwpK2lfVik7CgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7CgoJCWlmKCBpX2tleUxpZ2h0c09ubHkgIT0gMCApCgkJewoJCQlsaWdodHNvdXJjZSggImlza2V5bGlnaHQiLCBpc0tleUxpZ2h0ICk7CgkJfQoKCQlpZiggaXNLZXlMaWdodCAhPSAwICkKCQl7CgkJCWZsb2F0IG5vbnNwZWN1bGFyID0gMDsKCQkJbGlnaHRzb3VyY2UoICJfX25vbnNwZWN1bGFyIiwgbm9uc3BlY3VsYXIgKTsKCgkJCWlmKCBub25zcGVjdWxhciA8IDEgKQoJCQl7CgkJCQl2ZWN0b3IgTG4gPSBub3JtYWxpemUoTCk7CgoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7CgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsKCQkJCUMgKz0gY3VyX2NsICogcG93KG1heCgwLjAsaV9OLkgpLCBpX3NpemUpICogKDEtbm9uc3BlY3VsYXIpOwoJCQl9CgkJfQoJfQoJcmV0dXJuIEM7Cn0KCmNvbG9yIGdldFBob25nRSh2ZWN0b3IgaV9SOyBmbG9hdCBpX2hpZ2hsaWdodF9zaXplLCBpX3JvdWdobmVzczsKCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQp7CglleHRlcm4gcG9pbnQgUDsKCXZhcnlpbmcgY29sb3IgQyA9IDA7CgoJaWxsdW1pbmFuY2UoICJzcGVjdWxhciIsIFAsIGlfUiwgaV9oaWdobGlnaHRfc2l6ZSAqIFBJLzIgKQoJewoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOwoKCQlpZiggaV9rZXlMaWdodHNPbmx5ICE9IDAgKQoJCXsKCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOwoJCX0KCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApCgkJewoJCQlmbG9hdCBub25zcGVjdWxhciA9IDA7CgkJCWxpZ2h0c291cmNlKCAiX19ub25zcGVjdWxhciIsIG5vbnNwZWN1bGFyICk7CgoJCQlpZiggbm9uc3BlY3VsYXIgPCAxICkKCQkJewoJCQkJZmxvYXQgY29zX2FuZ2xlID0gbm9ybWFsaXplKEwpIC4gaV9SOwoJCQkJZmxvYXQgYW5nbGUgPSBhY29zKGNvc19hbmdsZSk7CgoJCQkJZmxvYXQgc3BlYyA9IHBvdyggY29zKGFuZ2xlIC8gaV9oaWdobGlnaHRfc2l6ZSksIHBvdyhpX3JvdWdobmVzcywgLTIpICk7CgoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7CgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsKCQkJCUMgKz0gc3BlYyAqIGN1cl9jbCAqICgxLW5vbnNwZWN1bGFyKTsKCQkJfQoJCX0KCX0KCXJldHVybiBDOwp9Cgpjb2xvciBnZXRHYXVzc2lhbih2ZWN0b3IgaV9JOyB2ZWN0b3IgaV9OOyBmbG9hdCBpX3JvdWdobmVzczsKCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQp7CglleHRlcm4gcG9pbnQgUDsKCWNvbG9yIEMgPSAwOwoKCWlsbHVtaW5hbmNlKCAic3BlY3VsYXIiLCBQICkKCXsKCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsKCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkKCQl7CgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsKCQl9CgoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQoJCXsKCQkJZmxvYXQgbm9uc3BlY3VsYXIgPSAwOwoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOwoKCQkJaWYoIG5vbnNwZWN1bGFyIDwgMSApCgkJCXsKCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsKCQkJCXZlY3RvciBIbiA9IG5vcm1hbGl6ZSgtaV9JICsgTG4pOwoKCQkJCWZsb2F0IHNwZWMgPSBleHAoIC1zcSggYWNvcyhpX04uSG4pIC8gaV9yb3VnaG5lc3MgKSApOwoKCQkJCXZhcnlpbmcgY29sb3IgY3VyX2NsOwoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07CgoJCQkJQyArPSBjdXJfY2wgKiBzcGVjICogKDEtbm9uc3BlY3VsYXIpOwoJCQl9CgkJfQoJfQoJcmV0dXJuIEM7Cn0KCmNvbG9yIGdldEdhdXNzaWFuRyh2ZWN0b3IgaV9JOyB2ZWN0b3IgaV9OOyBmbG9hdCBpX3JvdWdobmVzczsKCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQp7CglleHRlcm4gcG9pbnQgUDsKCWNvbG9yIEMgPSAwOwoKCWlsbHVtaW5hbmNlKCAic3BlY3VsYXIiLCBQICkKCXsKCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsKCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkKCQl7CgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsKCQl9CgoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQoJCXsKCQkJZmxvYXQgbm9uc3BlY3VsYXIgPSAwOwoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOwoKCQkJaWYoIG5vbnNwZWN1bGFyIDwgMSApCgkJCXsKCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsKCQkJCXZlY3RvciBIbiA9IG5vcm1hbGl6ZSgtaV9JICsgTG4pOwoKCQkJCWZsb2F0IHNwZWMgPSBleHAoIC1zcSggYWNvcyhpX04uSG4pIC8gaV9yb3VnaG5lc3MgKSApOwoJCQkJc3BlYyA9IHNtb290aHN0ZXAoMCwgMS8zLCBzcGVjKTsKCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsKCQkJCXsgY3VyX2NsID0gQ2w7IGlmKCB1bnNoYWRvd2VkICE9IDAgKSBsaWdodHNvdXJjZSgiX18zZGZtX3Vuc2hhZG93ZWRfY2wiLCBjdXJfY2wpOyB9OwoKCQkJCUMgKz0gY3VyX2NsICogc3BlYyAqICgxLW5vbnNwZWN1bGFyKTsKCQkJfQoJCX0KCX0KCXJldHVybiBDOwp9Cgpjb2xvciBnZXRDb29rVG9ycih2ZWN0b3IgaV9WOyB2ZWN0b3IgaV9OOyBmbG9hdCBpX3JvdWdobmVzczsgY29sb3IgaV9pb3I7Cgl1bmlmb3JtIGZsb2F0IGlfa2V5TGlnaHRzT25seSwgdW5zaGFkb3dlZCkKewoJZXh0ZXJuIHBvaW50IFA7CgoJZmxvYXQgZXRhciA9IDEvaV9pb3JbMF07CglmbG9hdCBldGFnID0gMS9pX2lvclsxXTsKCWZsb2F0IGV0YWIgPSAxL2lfaW9yWzJdOwoJZmxvYXQgS3QsIEtyciwgS3JnLCBLcmI7CglmcmVzbmVsKC1pX1YsIGlfTiwgZXRhciwgS3JyLCBLdCk7CglmcmVzbmVsKC1pX1YsIGlfTiwgZXRhZywgS3JnLCBLdCk7CglmcmVzbmVsKC1pX1YsIGlfTiwgZXRhYiwgS3JiLCBLdCk7CgoJY29sb3IgRiA9IGNvbG9yKEtyciwgS3JnLCBLcmIpOwoKCWNvbG9yIEMgPSAwOwoKCWlsbHVtaW5hbmNlKCBQLCBpX04sIFBJLzIpCgl7CgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7CgoJCWlmKCBpX2tleUxpZ2h0c09ubHkgIT0gMCApCgkJewoJCQlsaWdodHNvdXJjZSggImlza2V5bGlnaHQiLCBpc0tleUxpZ2h0ICk7CgkJfQoKCQlpZiggaXNLZXlMaWdodCAhPSAwICkKCQl7CgkJCWZsb2F0IG5vbnNwZWN1bGFyID0gMDsKCQkJbGlnaHRzb3VyY2UoICJfX25vbnNwZWN1bGFyIiwgbm9uc3BlY3VsYXIgKTsKCgkJCWlmKCBub25zcGVjdWxhciA8IDEgKQoJCQl7CgkJCQl2ZWN0b3IgTG4gPSBub3JtYWxpemUoTCk7CgkJCQl2ZWN0b3IgSG4gPSBub3JtYWxpemUoaV9WICsgTG4pOwoJCQkJZmxvYXQgTkggPSBpX04uSG47CgkJCQlmbG9hdCBhbHBoYSA9IGFjb3MoTkgpOwoJCQkJZmxvYXQgTlYgPSBpX04uaV9WOwoJCQkJZmxvYXQgTkwgPSBpX04uTG47CgkJCQlmbG9hdCBIViA9IEhuLmlfVjsKCgoJCQkJZmxvYXQgRzEgPSAoMiAqIE5IICogTlYpIC8gSFY7CgkJCQlmbG9hdCBHMiA9ICgyICogTkggKiBOTCkgLyBIVjsgICAgICAgICAKCQkJCWZsb2F0IEcgPSBtaW4oMSwgbWluKEcxLCBHMikpOwoKCgkJCQlmbG9hdCBfRCA9IHRhbihhbHBoYSkgLyBpX3JvdWdobmVzczsKCQkJCWZsb2F0IEQgPSBleHAoIC0gKF9EKl9EKSApIC8gCgkJCQkJKDQuMCAqIGlfcm91Z2huZXNzICogaV9yb3VnaG5lc3MgKiBwb3coY29zKGFscGhhKSwgNC4wKSk7CgoJCQkJY29sb3Igc3BlYyA9IEQqRypGL05WOwoKCQkJCXZhcnlpbmcgY29sb3IgY3VyX2NsOwoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07CgoJCQkJQyArPSBjdXJfY2wgKiBzcGVjICogKDEtbm9uc3BlY3VsYXIpOwoJCQl9CgkJfQoJfQoKCXJldHVybiBDOwp9Cgp2b2lkIGRvX2J1bXBfbWFwKAoJZmxvYXQgaV9idW1wVmFsdWU7CglmbG9hdCBpX2J1bXBEZXB0aDsKCW5vcm1hbCBpX25vcm1hbENhbWVyYTsKCW91dHB1dCBub3JtYWwgb19vdXROb3JtYWwgKQp7CglleHRlcm4gdmVjdG9yIGRQZHUsIGRQZHY7CgoJZmxvYXQgZGVwdGggPSBhYnMoaV9idW1wRGVwdGgpOwoJZmxvYXQgb2Zmc2V0ID0gY2xhbXAoaV9idW1wVmFsdWUgKiBpX2J1bXBEZXB0aCwgLWRlcHRoLCBkZXB0aCk7CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojbGluZSA4OTkgIi9hdG9tby9hcHBzL2xpbnV4L3g4Nl82NC9kZWxpZ2h0LzEwLjAuMTQ4L21heWEvcnNsLy9zaGFkaW5nX3V0aWxzLmgiCglleHRlcm4gcG9pbnQgUDsKCWV4dGVybiBub3JtYWwgTmc7CgoJbm9ybWFsIE5uID0gbm9ybWFsaXplKGlfbm9ybWFsQ2FtZXJhKTsKCW5vcm1hbCBOZ24gPSBub3JtYWxpemUoTmcpOwoJbm9ybWFsIE5vZmZzZXQgPSBObiAtIE5nbjsKCglmbG9hdCBzY2FsZSA9IDAuMjU7CgoJcG9pbnQgUHAgPQoJCXRyYW5zZm9ybSgid29ybGQiLCBQKSArCgkJbm9ybWFsaXplKG50cmFuc2Zvcm0oIndvcmxkIiwgTmduKSkgKiBvZmZzZXQgKiBzY2FsZTsKCU5uID0gLW50cmFuc2Zvcm0oIndvcmxkIiwgImN1cnJlbnQiLCBjYWxjdWxhdGVub3JtYWwoUHApKTsKCU5uID0gbm9ybWFsaXplKE5uKTsKCW9fb3V0Tm9ybWFsID0gbm9ybWFsaXplKE5uICsgTm9mZnNldCk7CgoKfQoKCgoKCgoKCgoKI2xpbmUgOTY1ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgpmbG9hdCByb3VnaG5lc3MoZmxvYXQgZ2xvc3MpCnsKCXJldHVybiBwb3coMi4wLCA4LjAgKiBnbG9zcyk7Cn0KCgoKCgoKCgojbGluZSA5NzcgIi9hdG9tby9hcHBzL2xpbnV4L3g4Nl82NC9kZWxpZ2h0LzEwLjAuMTQ4L21heWEvcnNsLy9zaGFkaW5nX3V0aWxzLmgiCmNvbG9yCkxvY0lsbHVtT3Jlbk5heWFyICgKCW5vcm1hbCBOOwoJdmVjdG9yIFY7CglmbG9hdCByb3VnaG5lc3M7Cgl1bmlmb3JtIGZsb2F0IGtleUxpZ2h0c09ubHk7IAoJdW5pZm9ybSBmbG9hdCB1bnNoYWRvd2VkOykKewoKCWZsb2F0IHNpZ21hMiA9IHJvdWdobmVzcyAqIHJvdWdobmVzczsKCWZsb2F0IEEgPSAxIC0gMC41ICogc2lnbWEyIC8gKHNpZ21hMiArIDAuMzMpOwoJZmxvYXQgQiA9IDAuNDUgKiBzaWdtYTIgLyAoc2lnbWEyICsgMC4wOSk7CgoJZmxvYXQgIHRoZXRhX3IgPSBhY29zIChWIC4gTik7ICAgICAgICAgCgl2ZWN0b3IgVl9wZXJwX04gPSBub3JtYWxpemUoVi1OKihWLk4pKTsgIAoKCgljb2xvciAgQyA9IDA7CglleHRlcm4gcG9pbnQgUDsKCWlsbHVtaW5hbmNlIChQLCBOLCBQSS8yKQoJewoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOwoKCQlpZigga2V5TGlnaHRzT25seSAhPSAwICkKCQl7CgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsKCQl9CgoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQoJCXsKCgkJCWV4dGVybiB2ZWN0b3IgTDsKCQkJdW5pZm9ybSBmbG9hdCBub25kaWZmID0gMDsKCQkJbGlnaHRzb3VyY2UgKCJfX25vbmRpZmZ1c2UiLCBub25kaWZmKTsKCQkJaWYgKG5vbmRpZmYgPT0gMCkKCQkJewoJCQkJdmVjdG9yIExOID0gbm9ybWFsaXplKEwpOwoJCQkJZmxvYXQgY29zX3RoZXRhX2kgPSBMTiAuIE47CgkJCQlmbG9hdCBjb3NfcGhpX2RpZmYgPSBWX3BlcnBfTiAuIG5vcm1hbGl6ZShMTiAtIE4qY29zX3RoZXRhX2kpOwoJCQkJZmxvYXQgdGhldGFfaSA9IGFjb3MgKGNvc190aGV0YV9pKTsKCQkJCWZsb2F0IGFscGhhID0gbWF4ICh0aGV0YV9pLCB0aGV0YV9yKTsKCQkJCWZsb2F0IGJldGEgPSBtaW4gKHRoZXRhX2ksIHRoZXRhX3IpOwoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7CgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsKCQkJCUMgKz0gY3VyX2NsICogY29zX3RoZXRhX2kgKiAKCQkJCShBICsgQiAqIG1heCgwLGNvc19waGlfZGlmZikgKiBzaW4oYWxwaGEpICogdGFuKGJldGEpKTsKCQkJfQoJCX0KCX0KCXJldHVybiBDOwp9CgoKZmxvYXQgY29tcHV0ZV9zYW1wbGluZ19hbmdsZSggZmxvYXQgZ2xvc3NpbmVzczsgKQp7CglpZiggZ2xvc3NpbmVzcyA+PSAxLjAgKQoJCXJldHVybiAwLjA7CgllbHNlCiAgICByZXR1cm4gKDEuMCAtIHBvdyhjbGFtcChnbG9zc2luZXNzLCAwLjAsIDEuMCksIDAuMikpICogUEkgLyAyLjA7Cn0KCmNvbG9yIHRyYWNlX3JlZmxlY3Rpb24oCgl2ZWN0b3IgSW47Cglub3JtYWwgTmY7Cgl2ZWN0b3IgVjsKCXVuaWZvcm0gZmxvYXQgaV9yZWZsX2dsb3NzOwoJdW5pZm9ybSBmbG9hdCBpX3JlZmxfZ2xvc3Nfc2FtcGxlczsKCXVuaWZvcm0gZmxvYXQgaV91c2VfbWF4X2Rpc3Q7Cgl1bmlmb3JtIGZsb2F0IGlfbWF4X2Rpc3Q7Cgl1bmlmb3JtIGZsb2F0IGlfZG9fcmVmbF9mYWxsb2ZmOwoJdmFyeWluZyBjb2xvciBpX3JlZmxfZmFsbG9mZl9jb2xvcjsKCXZhcnlpbmcgY29sb3IgaV93ZWlnaHQgKQp7CglleHRlcm4gcG9pbnQgUDsKCWV4dGVybiB1bmlmb3JtIGZsb2F0IF9fcmVmbGVjdHM7CgoJaWYoIF9fcmVmbGVjdHMgPT0gMCApCgl7CgkJcmV0dXJuIGNvbG9yKDApOwoJfQoKCgl1bmlmb3JtIGZsb2F0IHNhbXBsZV9hbmdsZSA9IGNvbXB1dGVfc2FtcGxpbmdfYW5nbGUoIGlfcmVmbF9nbG9zcyApOwoJdW5pZm9ybSBmbG9hdCBzYW1wbGVfY291bnQgPSAoaV9yZWZsX2dsb3NzID09IDApID8KCQltaW4oNCwgaV9yZWZsX2dsb3NzX3NhbXBsZXMpIDogaV9yZWZsX2dsb3NzX3NhbXBsZXM7CgoKCXZlY3RvciByZWZsX2RpciA9IHJlZmxlY3QoSW4sIE5mKTsKCgl1bmlmb3JtIGZsb2F0IG1heF9kaXN0ID0gaV91c2VfbWF4X2Rpc3QgPiAxZS02ID8gaV9tYXhfZGlzdCA6IDFlMzg7CgoJY29sb3IgdHJzID0gMDsKCWZsb2F0IGRpc3QgPSAwOwoKCWZsb2F0IGZhZGUgPSAxLjA7CglpZiggaV91c2VfbWF4X2Rpc3QgIT0gMCApCgl7CgkJZmFkZSA9IHBvdyggKCBjbGFtcCggMSAtIGRpc3QgLyBtYXhfZGlzdCwgMCwgMSApICksIDIgKTsKCX0KCgljb2xvciByZWZsZWN0aW9uID0gdHJhY2UoIAoJCVAsIHJlZmxfZGlyLCBkaXN0LCAKCQkic2FtcGxlY29uZSIsIHNhbXBsZV9hbmdsZSwKCQkic2FtcGxlcyIsIHNhbXBsZV9jb3VudCwgCgkJInRyYW5zbWlzc2lvbiIsIHRycywgCgkJInN1YnNldCIsICItXzNkZm1fbm90X3Zpc2libGVfaW5fcmVmbGVjdGlvbnMiLAoJCSJtYXhkaXN0IiwgbWF4X2Rpc3QsCgkJIndlaWdodCIsIGlfd2VpZ2h0KmZhZGUgKTsKCglyZWZsZWN0aW9uICo9IGZhZGU7CgoJZXh0ZXJuIGNvbG9yIF9fdHJhbnNwYXJlbmN5OwkKCgoKCgoKCgoKCgoKCgoKCglpZiggdHJzICE9IDAgKQoJewoJCWNvbG9yIGVudl9jb2xvciA9IDA7CgoJCWlmKCBpX2RvX3JlZmxfZmFsbG9mZiAhPSAwICkKCQl7CgkJCWVudl9jb2xvciA9IGlfcmVmbF9mYWxsb2ZmX2NvbG9yOwoJCX0KCQllbHNlCgkJewoJCQllbnZfY29sb3IgPSBnZXRHaUVudmlyb25tZW50U3BlY3VsYXIocmVmbF9kaXIsIHNhbXBsZV9jb3VudCwgc2FtcGxlX2FuZ2xlKTsKCQl9CgoJCWlmKCBpX3VzZV9tYXhfZGlzdCAhPSAwICkKCQl7CgkJCWVudl9jb2xvciAqPSAoMSAtIGZhZGUpOwoJCX0KCgkJZW52X2NvbG9yICo9IHRyczsKCgoKCgoKCgoKCgoJCXJlZmxlY3Rpb24gKz0gZW52X2NvbG9yOwoJfQoKCXJldHVybiByZWZsZWN0aW9uOwp9Cgpjb2xvciB0cmFjZV9yZWZyYWN0aW9uKAoJbm9ybWFsIE5uOwoJdmVjdG9yIEluOwoJbm9ybWFsIE5mOwoJdmVjdG9yIFY7CglmbG9hdCBpX3JlZnJfaW9yOwoJdW5pZm9ybSBmbG9hdCBpX3JlZnJfZ2xvc3M7Cgl1bmlmb3JtIGZsb2F0IGlfcmVmcl9nbG9zc19zYW1wbGVzOwoJb3V0cHV0IGZsb2F0IG9fdG90YWxfaW50ZXJuYWxfcmVmbDsKCXZhcnlpbmcgY29sb3IgaV93ZWlnaHQgKQp7CglleHRlcm4gcG9pbnQgUDsKCWV4dGVybiB1bmlmb3JtIGZsb2F0IF9fcmVmcmFjdHM7CgoJaWYoIF9fcmVmcmFjdHMgPT0gMCApCgl7CgkJb190b3RhbF9pbnRlcm5hbF9yZWZsID0gMDsKCQlyZXR1cm4gY29sb3IoMCk7Cgl9CgoKCXVuaWZvcm0gZmxvYXQgc2FtcGxlX2FuZ2xlID0gY29tcHV0ZV9zYW1wbGluZ19hbmdsZSggaV9yZWZyX2dsb3NzICk7Cgl1bmlmb3JtIGZsb2F0IHNhbXBsZV9jb3VudCA9IChpX3JlZnJfZ2xvc3MgPT0gMCkgPwoJCW1pbig0LCBpX3JlZnJfZ2xvc3Nfc2FtcGxlcykgOiBpX3JlZnJfZ2xvc3Nfc2FtcGxlczsKCgoJZmxvYXQgZXRhID0gKEluIC4gTm4gPCAwLjApID8gMS4wIC8gaV9yZWZyX2lvciA6IGlfcmVmcl9pb3I7Cgl2ZWN0b3IgcmVmcl9kaXIgPSByZWZyYWN0KEluLCBOZiwgZXRhKTsKCWNvbG9yIHJlZnJhY3Rpb24gPSAwOwoKCWlmKCBsZW5ndGgoIHJlZnJfZGlyICkgPD0gMWUtNiApCgl7CgkJb190b3RhbF9pbnRlcm5hbF9yZWZsID0gMTsKCQlyZWZyYWN0aW9uID0gMDsKCX0KCWVsc2UKCXsKCQljb2xvciB0cnMgPSAwOwoJCXJlZnJhY3Rpb24gPSB0cmFjZSggCgkJCVAsIHJlZnJfZGlyLCAKCQkJInNhbXBsZWNvbmUiLCBzYW1wbGVfYW5nbGUsCgkJCSJzYW1wbGVzIiwgc2FtcGxlX2NvdW50LAoJCQkic3Vic2V0IiwgIi1fM2RmbV9ub3RfdmlzaWJsZV9pbl9yZWZyYWN0aW9ucyIsIAoJCQkidHJhbnNtaXNzaW9uIiwgdHJzLAoJCQkid2VpZ2h0IiwgaV93ZWlnaHQgKTsKCgkJaWYoIHRycyAhPSAwICkKCQl7CgkJCWNvbG9yIGVudl9jb2xvciA9IGdldEdpRW52aXJvbm1lbnRTcGVjdWxhcihyZWZyX2Rpciwgc2FtcGxlX2NvdW50LCBzYW1wbGVfYW5nbGUpOwoJCQlyZWZyYWN0aW9uICs9IGVudl9jb2xvciAqIHRyczsKCQl9CgoJCW9fdG90YWxfaW50ZXJuYWxfcmVmbCA9IDA7Cgl9CgoJcmV0dXJuIHJlZnJhY3Rpb247Cn0KCgoKCgoKCgojbGluZSAxMjA2ICIvYXRvbW8vYXBwcy9saW51eC94ODZfNjQvZGVsaWdodC8xMC4wLjE0OC9tYXlhL3JzbC8vc2hhZGluZ191dGlscy5oIgpjb2xvciBzcGVjdWxhcl9oaWdobGlnaHQoCgl2ZWN0b3IgSW47Cglub3JtYWwgTmY7Cgl2ZWN0b3IgVjsKCWZsb2F0ICByZWZsX3JvdWdobmVzc191LCByZWZsX3JvdWdobmVzc192OwoJdW5pZm9ybSBmbG9hdCBrZXlMaWdodHNPbmx5OyAKCXVuaWZvcm0gZmxvYXQgdW5zaGFkb3dlZDspCnsKCWV4dGVybiBjb2xvciBDbDsKCWV4dGVybiB2ZWN0b3IgZFBkdSwgZFBkdjsKCWV4dGVybiBwb2ludCBQOwoKCXZlY3RvciB4ZGlyID0gbm9ybWFsaXplKCBkUGR1ICk7Cgl2ZWN0b3IgeWRpciA9IG5vcm1hbGl6ZSggZFBkdiApOwoKCXhkaXIgPSBub3JtYWxpemUoTmZeeGRpcl5OZik7CiAJeWRpciA9IG5vcm1hbGl6ZShOZl55ZGlyXk5mKTsKCgljb2xvciBoaWdobGlnaHRzID0gMDsKCgoKI2xpbmUgMTIyOCAiL2F0b21vL2FwcHMvbGludXgveDg2XzY0L2RlbGlnaHQvMTAuMC4xNDgvbWF5YS9yc2wvL3NoYWRpbmdfdXRpbHMuaCIKCXVuaWZvcm0gZmxvYXQgY29tcG9uZW50X2NvZWZzWzNdID0gezAuNSwgMS4wLCAxLjV9OyAKCglpbGx1bWluYW5jZSggUCwgTmYsIFBJICogMC41ICkKCXsKCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsKCgkJaWYoIGtleUxpZ2h0c09ubHkgIT0gMCApCgkJewoJCQlsaWdodHNvdXJjZSggImlza2V5bGlnaHQiLCBpc0tleUxpZ2h0ICk7CgkJfQoKCQlpZiggaXNLZXlMaWdodCAhPSAwICkKCQl7CgkJCXVuaWZvcm0gZmxvYXQgbm9uc3BlY3VsYXIgPSAwOwoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOwoKCQkJaWYoIG5vbnNwZWN1bGFyID09IDAgKQoJCQl7CgkJCQl2ZWN0b3IgTG4gPSBub3JtYWxpemUoTCk7CgoJCQkJZmxvYXQgZG90X2xuID0gTG4gLiBOZjsKCQkJCWZsb2F0IGRvdF92biA9IFYgLiBOZjsKCgkJCQlpZiggZG90X3ZuKmRvdF9sbj4wLjAgKQoJCQkJewoJCQkJCXZlY3RvciBIbiA9IG5vcm1hbGl6ZShWICsgTG4pOwoJCQkJCWZsb2F0IGRvdF9objIgPSBtaW4oc3EoSG4gLiBOZiksIDEuMCk7CgoJCQkJCWlmKCBkb3RfaG4yPjAuMCApCgkJCQkJewoKCQkJCQkJZmxvYXQgazFfZGV2aWRlciA9IDEgLyAoc3FydChkb3Rfdm4gKiBkb3RfbG4pICogNC4wICogUEkpOyAgCgkJCQkJCWZsb2F0IHNtb290aF9zdGVwX2xuID0gc21vb3Roc3RlcCggMCwgMC4yNSwgZG90X2xuICk7CgoJCQkJCQl1bmlmb3JtIGZsb2F0IGk9MDsKCQkJCQkJdW5pZm9ybSBmbG9hdCByb3VnaG5lc3NfY29lZiA9IDE7CgoJCQkJCQlmb3IoIGk9MDsgaTwzOyBpKz0xLjAgKQoJCQkJCQl7CgoJCQkJCQkJZmxvYXQgazEgPQoJCQkJCQkJCShyZWZsX3JvdWdobmVzc191ICogcmVmbF9yb3VnaG5lc3NfdiAqIHJvdWdobmVzc19jb2VmICogcm91Z2huZXNzX2NvZWYgKQoJCQkJCQkJCSogazFfZGV2aWRlcjsKCQkJCQkJCWZsb2F0IGsyID0KCQkJCQkJCQlzcShIbiAuIHhkaXIgKiByZWZsX3JvdWdobmVzc191ICogcm91Z2huZXNzX2NvZWYpCgkJCQkJCQkJKyBzcShIbiAuIHlkaXIgKiByZWZsX3JvdWdobmVzc192ICogcm91Z2huZXNzX2NvZWYpOwoJCQkJCQkJY29sb3IgYyA9CgkJCQkJCQkJazEgKiBleHAoLWsyIC8gZG90X2huMikKCQkJCQkJCQkqIGRvdF9sbgoJCQkJCQkJCSogc21vb3RoX3N0ZXBfbG47CgoJCQkJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7CgkJCQkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsKCgkJCQkJCQloaWdobGlnaHRzICs9IGN1cl9jbCAqIGMgKiBjb21wb25lbnRfY29lZnNbaV07CgoJCQkJCQkJcm91Z2huZXNzX2NvZWYgKj0gMC41OwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQoKCXJldHVybiBoaWdobGlnaHRzOwp9CgoKCgojbGluZSAxODggIi9hdG9tby9hcHBzL2xpbnV4L3g4Nl82NC9kZWxpZ2h0LzEwLjAuMTQ4L21heWEvcnNsLy9sYW1iZXJ0LmgiCgp2b2lkCm1heWFfbGFtYmVydCgKCgoJY29sb3IgaV9hbWJpZW50Q29sb3I7Cgljb2xvciBpX2NvbG9yOwoJZmxvYXQgaV9kaWZmdXNlOwoJY29sb3IgaV9pbmNhbmRlc2NlbmNlOwoJZmxvYXQgaV9tYXR0ZU9wYWNpdHlNb2RlOwoJZmxvYXQgaV9tYXR0ZU9wYWNpdHk7CgoKCXVuaWZvcm0gZmxvYXQgaV9yZWZyYWN0aW9uczsKCWZsb2F0IGlfcmVmcmFjdGl2ZUluZGV4OwoJdW5pZm9ybSBmbG9hdCBpX3JlZnJhY3Rpb25MaW1pdDsKCWZsb2F0IGlfbGlnaHRBYnNvcmJhbmNlOwoJZmxvYXQgaV9zaGFkb3dBdHRlbnVhdGlvbjsKCglub3JtYWwgaV9ub3JtYWxDYW1lcmE7Cgljb2xvciBpX3RyYW5zcGFyZW5jeTsKCWZsb2F0IGlfdHJhbnNsdWNlbmNlLCBpX3RyYW5zbHVjZW5jZURlcHRoLCBpX3RyYW5zbHVjZW5jZUZvY3VzOwoKCgoJb3V0cHV0IGNvbG9yIG9fb3V0Q29sb3I7CglvdXRwdXQgY29sb3Igb19vdXRUcmFuc3BhcmVuY3k7CgkpCnsKCWV4dGVybiBjb2xvciBDczsKCWV4dGVybiB2ZWN0b3IgSTsKCglvX291dENvbG9yID0gaV9jb2xvciAqIENzOwoKCgl2YXJ5aW5nIGNvbG9yIHBob3Rvbl9kaWZmID0gaV9kaWZmdXNlICogb19vdXRDb2xvcjsKCXN0cmluZyByYXlUeXBlOyBpZiggMSA9PSByYXlpbmZvKCAidHlwZSIsIHJheVR5cGUgKSAmJiByYXlUeXBlID09ICJsaWdodCIgKSB7IHN0cmluZyBzaGFkaW5nbW9kZWw7IGlmKCAxID09IGF0dHJpYnV0ZSggInBob3RvbjpzaGFkaW5nbW9kZWwiLCBzaGFkaW5nbW9kZWwgKSAmJiBzaGFkaW5nbW9kZWwgPT0gIm1hdHRlIiApIHsgb19vdXRDb2xvciA9IHBob3Rvbl9kaWZmOyB9IGVsc2UgeyBvX291dENvbG9yID0gb19vdXRDb2xvcjsgfSBvX291dFRyYW5zcGFyZW5jeSA9IGlfdHJhbnNwYXJlbmN5OyB9IGVsc2UgewoKCW5vcm1hbCBObiA9IG5vcm1hbGl6ZShpX25vcm1hbENhbWVyYSk7Cglub3JtYWwgTmYgPSBTaGFkaW5nTm9ybWFsKE5uKTsKCgljb2xvciBJYSA9IGlfYW1iaWVudENvbG9yICsgZ2V0QW1iaWVudChOZik7Cgljb2xvciBJZCA9IGdldERpZmZ1c2UoTmYsIDAsIDApOwoJY29sb3IgSXRyID0gZ2V0VHJhbnNsdWNlbmNlKAoJCU5mLCBpX3RyYW5zbHVjZW5jZSwgaV90cmFuc2x1Y2VuY2VEZXB0aCwgaV90cmFuc2x1Y2VuY2VGb2N1cyApOyAKCWNvbG9yIElpbmRpcmVjdERpZmZ1c2UgPSAwOwoKCWNvbXB1dGVTdXJmYWNlKAoJCW9fb3V0Q29sb3IsCgkJaV90cmFuc3BhcmVuY3ksCgkJaV9tYXR0ZU9wYWNpdHlNb2RlLAoJCWlfbWF0dGVPcGFjaXR5LAoJCW9fb3V0Q29sb3IsCgkJb19vdXRUcmFuc3BhcmVuY3kgKTsKCgoKCglJZCAqPSBpX2RpZmZ1c2U7CgoJZXh0ZXJuIGNvbG9yIF9fdHJhbnNwYXJlbmN5OwoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgljb2xvciByZWZyYWN0aW9uOwoKCWRvUmVmcmFjdGlvbigKCQlObiwKCQlJLAoJCWlfcmVmcmFjdGlvbnMsCgkJaV9yZWZyYWN0aXZlSW5kZXgsCgkJaV9yZWZyYWN0aW9uTGltaXQsCgkJaV9saWdodEFic29yYmFuY2UsCgkJaV9zaGFkb3dBdHRlbnVhdGlvbiwKCQlvX291dFRyYW5zcGFyZW5jeSwKCQlyZWZyYWN0aW9uICk7CgoKCUlpbmRpcmVjdERpZmZ1c2UgPSBjb21wdXRlSW5kaXJlY3REaWZmdXNlQW5kR0lBT1ZzKAoJCWlfZGlmZnVzZSwgb19vdXRDb2xvciwgb19vdXRUcmFuc3BhcmVuY3ksIE5mICk7CgoKCgoKCgoKCgoKCgoKCW9fb3V0Q29sb3IgPQoJCW9fb3V0Q29sb3IgKiAoSWEgKyBJZCArIElpbmRpcmVjdERpZmZ1c2UgKyBJdHIpCgkJKyBpX2luY2FuZGVzY2VuY2UgKyByZWZyYWN0aW9uOwoKCgoKCgoJY29tcHV0ZVNoYWRvd1Bhc3MoTmYpOwoKCgoKCgoKCgoJX190cmFuc3BhcmVuY3kgKj0gb19vdXRUcmFuc3BhcmVuY3k7CgoJfQp9CgoKCiNsaW5lIDEzMiAiL2F0b21vL3BpcGVsaW5lL3Rvb2xzL3NoYWRlcnMvZGVsaWdodC9zcmMvbGFtYmVydDEuc2wiCgoKCgljb2xvciBsYW1iZXJ0MV9vdXRDb2xvcl9sb2NhbCA9IGNvbG9yKDAsMCwwKTsKCWNvbG9yIGxhbWJlcnQxX291dFRyYW5zcGFyZW5jeV9sb2NhbCA9IGNvbG9yKDAsMCwwKTsKCgoKCW1heWFfbGFtYmVydCgKCQljb2xvcigwLCAwLCAwKSwgIAoJCWNvbG9yKDAuNSwgMC41LCAwLjUpLCAgCgkJMC44MDAwMDAwMTE5LCAgCgkJY29sb3IoMCwgMCwgMCksICAKCQkyLCAgCgkJMSwgIAoJCTAsICAKCQkxLCAgCgkJNiwgIAoJCTAsICAKCQkwLjUsICAKCQlOLCAgCgkJY29sb3IoMCwgMCwgMCksICAKCQkwLCAgCgkJMC41LCAgCgkJMC41LCAgCgkJbGFtYmVydDFfb3V0Q29sb3JfbG9jYWwsCgkJbGFtYmVydDFfb3V0VHJhbnNwYXJlbmN5X2xvY2FsCgkJKTsKCgoKCU9pID0gT3MgKiAoMS4wIC0gbGFtYmVydDFfb3V0VHJhbnNwYXJlbmN5X2xvY2FsKTsKCUNpID0gbGFtYmVydDFfb3V0Q29sb3JfbG9jYWwgKiBPczsKCglpbGx1bWluYW5jZSggImJha2VsaWdodCIsIFAsICJzZW5kOmxpZ2h0OmRvX2Jha2UiLCAxICkKCXsKCX0KfQoKCgo="
%comment-user 7 121
0

